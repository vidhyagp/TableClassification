=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="0" height="25" left="135" textpieces="0" top="108" width="645">Towards Energy-Efcient Database Cluster Design</text>
2 <text font="1" height="17" left="195" textpieces="0" top="175" width="87">Willis Lang</text>
2 <text font="2" height="14" left="161" textpieces="0" top="193" width="154">University of Wisconsin</text>
2 <text font="1" height="17" left="159" textpieces="0" top="215" width="157">wlang@cs.wisc.edu</text>
2 <text font="1" height="17" left="372" textpieces="0" top="175" width="170">Stavros Harizopoulos</text>
2 <text font="2" height="14" left="426" textpieces="0" top="193" width="63">Nou Data</text>
2 <text font="1" height="17" left="368" textpieces="0" top="213" width="179">stavros@noudata.com</text>
2 <text font="1" height="17" left="611" textpieces="0" top="175" width="132">Jignesh M. Patel</text>
2 <text font="2" height="14" left="600" textpieces="0" top="193" width="154">University of Wisconsin</text>
2 <text font="1" height="17" left="593" textpieces="0" top="215" width="167">jignesh@cs.wisc.edu</text>
2 <text font="1" height="17" left="289" textpieces="0" top="241" width="118">Mehul A. Shah</text>
2 <text font="2" height="14" left="316" textpieces="0" top="259" width="63">Nou Data</text>
2 <text font="1" height="17" left="262" textpieces="0" top="279" width="171">mehul@noudata.com</text>
2 <text font="1" height="17" left="486" textpieces="0" top="241" width="162">Dimitris Tsirogiannis</text>
2 <text font="2" height="14" left="516" textpieces="0" top="259" width="101">Microsoft Corp.</text>
2 <text font="1" height="17" left="474" textpieces="0" top="281" width="187">dimitsir@microsoft.com</text>
2 <text font="1" height="16" left="81" textpieces="0" top="321" width="97">ABSTRACT</text>
2 <text font="3" height="12" left="81" textpieces="0" top="346" width="359">Energy is a growing component of the operational cost for many</text>
2 <text font="3" height="12" left="79" textpieces="0" top="361" width="363">big data deployments, and hence has become increasingly im-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="377" width="359">portant for practitioners of large-scale data analysis who require</text>
2 <text font="3" height="12" left="81" textpieces="0" top="393" width="359">scale-out clusters or parallel DBMS appliances. Although a number</text>
2 <text font="3" height="12" left="81" textpieces="0" top="409" width="360">of recent studies have investigated the energy efciency of DBMSs,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="424" width="359">none of these studies have looked at the architectural design space of</text>
2 <text font="3" height="12" left="81" textpieces="0" top="440" width="359">energy-efcient parallel DBMS clusters. There are many challenges</text>
2 <text font="3" height="12" left="81" textpieces="0" top="456" width="359">to increasing the energy efciency of a DBMS cluster, including</text>
2 <text font="3" height="12" left="81" textpieces="0" top="471" width="361">dealing with the inherent scaling inefciency of parallel data pro-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="487" width="359">cessing, and choosing the appropriate energy-efcient hardware. In</text>
2 <text font="3" height="12" left="81" textpieces="0" top="503" width="359">this paper, we experimentally examine and analyze a number of key</text>
2 <text font="3" height="12" left="81" textpieces="0" top="518" width="359">parameters related to these challenges for designing energy-efcient</text>
2 <text font="3" height="12" left="81" textpieces="0" top="534" width="361">database clusters. We explore the cluster design space using empiri-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="550" width="359">cal results and propose a model that considers the key bottlenecks</text>
2 <text font="3" height="12" left="81" textpieces="0" top="565" width="359">to energy efciency in a parallel DBMS. This paper represents a</text>
2 <text font="3" height="12" left="81" textpieces="0" top="581" width="359">key rst step in designing energy-efcient database clusters, which</text>
2 <text font="3" height="12" left="81" textpieces="0" top="597" width="359">is increasingly important given the trend toward parallel database</text>
2 <text font="3" height="12" left="81" textpieces="0" top="613" width="60">appliances.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="653" width="174">1.  INTRODUCTION</text>
2 <text font="3" height="12" left="94" textpieces="0" top="676" width="352">In recent years, energy efciency has become an important database</text>
2 <text font="3" height="12" left="81" textpieces="0" top="692" width="359">research topic since the cost of powering clusters is a big component</text>
2 <text font="3" height="12" left="81" textpieces="0" top="708" width="359">of the total operational cost [13, 15, 19]. As big data becomes</text>
2 <text font="3" height="12" left="81" textpieces="0" top="723" width="361">the norm in various industries, the use of clusters to analyze ever-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="739" width="359">increasing volumes of data will continue to increase. In turn, this</text>
2 <text font="3" height="12" left="81" textpieces="0" top="755" width="359">trend will drive up the need for designing energy-efcient data</text>
2 <text font="3" height="12" left="81" textpieces="0" top="770" width="359">processing clusters. The focus of this paper is on designing such</text>
2 <text font="3" height="12" left="81" textpieces="0" top="786" width="342">energy-efcient clusters for database analytic query processing.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="802" width="347">One important problem regarding the energy efciency of database</text>
2 <text font="3" height="12" left="81" textpieces="0" top="817" width="359">clusters surrounds the classical problem of non-linear scalability in</text>
2 <text font="3" height="12" left="81" textpieces="0" top="833" width="359">parallel data processing [12]. Non-linear scalability refers to the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="849" width="359">inability of a parallel system to proportionally increase performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="864" width="360">as the computational resources/nodes are increased. More recently,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="880" width="359">it was shown that modern parallel DBMSs are still subject to these</text>
2 <text font="3" height="12" left="81" textpieces="0" top="896" width="359">scalability pitfalls that affect their performance and increase their</text>
2 <text font="3" height="12" left="81" textpieces="0" top="912" width="151">total operating cost [25, 31].</text>
=============================== COL ===================================
2 <text font="4" height="10" left="650" textpieces="0" top="504" width="2"> </text>
2 <text font="5" height="9" left="596" textpieces="0" top="360" width="12">8N </text>
2 <text font="5" height="9" left="563" textpieces="0" top="356" width="17">10N </text>
2 <text font="5" height="9" left="538" textpieces="0" top="350" width="17">12N </text>
2 <text font="5" height="9" left="518" textpieces="0" top="368" width="17">14N </text>
2 <text font="5" height="9" left="503" textpieces="0" top="335" width="17">16N </text>
2 <text font="5" height="9" left="491" textpieces="0" top="477" width="11">0.0</text>
2 <text font="5" height="9" left="491" textpieces="0" top="464" width="11">0.1</text>
2 <text font="5" height="9" left="491" textpieces="0" top="451" width="11">0.2</text>
2 <text font="5" height="9" left="491" textpieces="0" top="438" width="11">0.3</text>
2 <text font="5" height="9" left="491" textpieces="0" top="425" width="11">0.4</text>
2 <text font="5" height="9" left="491" textpieces="0" top="412" width="11">0.5</text>
2 <text font="5" height="9" left="491" textpieces="0" top="399" width="11">0.6</text>
2 <text font="5" height="9" left="491" textpieces="0" top="386" width="11">0.7</text>
2 <text font="5" height="9" left="491" textpieces="0" top="373" width="11">0.8</text>
2 <text font="5" height="9" left="491" textpieces="0" top="360" width="11">0.9</text>
2 <text font="5" height="9" left="491" textpieces="0" top="347" width="11">1.0</text>
2 <text font="5" height="9" left="629" textpieces="2" top="489" width="-110">0.50                          0.75                          1.00</text>
2 <text font="6" height="11" left="483" textpieces="0" top="479" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="512" textpieces="0" top="499" width="111">Normalized Performance </text>
2 <text font="7" height="13" left="511" textpieces="0" top="322" width="106">Varying Cluster Sizes </text>
2 <text font="4" height="10" left="831" textpieces="0" top="504" width="2"> </text>
2 <text font="5" height="9" left="675" textpieces="0" top="335" width="26">8B,0W </text>
2 <text font="5" height="9" left="686" textpieces="0" top="372" width="26">7B,1W </text>
2 <text font="5" height="9" left="698" textpieces="0" top="383" width="26">6B,2W </text>
2 <text font="5" height="9" left="714" textpieces="0" top="395" width="26">5B,3W </text>
2 <text font="5" height="9" left="734" textpieces="0" top="406" width="26">4B,4W </text>
2 <text font="5" height="9" left="761" textpieces="0" top="417" width="26">3B,5W </text>
2 <text font="5" height="9" left="796" textpieces="0" top="427" width="26">2B,6W </text>
2 <text font="5" height="9" left="668" textpieces="0" top="478" width="11">0.0</text>
2 <text font="5" height="9" left="668" textpieces="0" top="465" width="11">0.1</text>
2 <text font="5" height="9" left="668" textpieces="0" top="452" width="11">0.2</text>
2 <text font="5" height="9" left="668" textpieces="0" top="439" width="11">0.3</text>
2 <text font="5" height="9" left="668" textpieces="0" top="426" width="11">0.4</text>
2 <text font="5" height="9" left="668" textpieces="0" top="413" width="11">0.5</text>
2 <text font="5" height="9" left="668" textpieces="0" top="400" width="11">0.6</text>
2 <text font="5" height="9" left="668" textpieces="0" top="387" width="11">0.7</text>
2 <text font="5" height="9" left="668" textpieces="0" top="374" width="11">0.8</text>
2 <text font="5" height="9" left="668" textpieces="0" top="360" width="11">0.9</text>
2 <text font="5" height="9" left="668" textpieces="0" top="347" width="11">1.0</text>
2 <text font="5" height="9" left="810" textpieces="3" top="490" width="-115">0.70                    0.80                   0.90                    1.00</text>
2 <text font="6" height="11" left="663" textpieces="0" top="482" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="687" textpieces="0" top="499" width="111">Normalized Performance </text>
2 <text font="7" height="13" left="686" textpieces="0" top="322" width="121">Varying Cluster Designs </text>
2 <text font="3" height="12" left="561" textpieces="1" top="518" width="188">(a)                            (b)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="536" width="359">Figure 1: (a) Empirical energy consumption and performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="551" width="361">results for Vertica running TPC-H Q12 (at scale factor of 1000).</text>
2 <text font="3" height="12" left="475" textpieces="0" top="567" width="361">The dotted line indicates trading an X% decrease in perfor-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="583" width="361">mance for an X% decrease in energy consumed so that the En-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="598" width="359">ergy Delay Product (EDP= energy  delay) metric is constant</text>
2 <text font="3" height="12" left="475" textpieces="0" top="614" width="361">relative to the 16 node cluster. (b) Modeled performance and en-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="630" width="359">ergy efciency of an 8 node cluster made of various traditional</text>
2 <text font="3" height="12" left="475" textpieces="0" top="646" width="359">Beefy nodes and low-power Wimpy nodes when performing a</text>
2 <text font="3" height="12" left="475" textpieces="0" top="661" width="361">parallel hash join on our custom parallel execution engine P-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="677" width="361">store. Wimpy nodes only scan and lter the data before shuf-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="693" width="359">ing it to the Beefy nodes for further processing. A constant</text>
2 <text font="3" height="12" left="475" textpieces="0" top="708" width="361">EDP relative to the all Beefy cluster is shown by the dotted line.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="735" width="227">1.1  Illustrative Experiments</text>
2 <text font="3" height="12" left="489" textpieces="0" top="757" width="345">First, we present two results that show how varying the cluster size</text>
2 <text font="3" height="12" left="475" textpieces="0" top="773" width="359">and changing the cluster design can allow us to trade performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="789" width="329">for reduced energy consumption for a single query workload.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="804" width="346">In this paper, we studied the effect of this undesirable scalability</text>
2 <text font="3" height="12" left="475" textpieces="0" top="820" width="359">phenomenon on the energy efciency of parallel data processing</text>
2 <text font="3" height="12" left="475" textpieces="0" top="836" width="359">clusters using a number of parallel DBMSs, including Vertica and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="851" width="359">HadoopDB. Our rst result is shown in Figure 1(a) for TPC-H</text>
2 <text font="3" height="12" left="475" textpieces="0" top="867" width="359">Q12 (at scale factor 1000) for Vertica. In this gure, we show</text>
2 <text font="3" height="12" left="475" textpieces="0" top="883" width="359">the relative change, compared to a 16 node cluster, in the energy</text>
2 <text font="3" height="12" left="475" textpieces="1" top="898" width="359">consumed by the cluster and the query performance1as we decrease</text>
2 <text font="3" height="12" left="475" textpieces="0" top="914" width="359">the cluster size two nodes at a time (please see Section 3.1 for more</text>
2 <text font="3" height="12" left="475" textpieces="0" top="930" width="359">details). Next, we discuss three key insights that can be drawn from</text>
2 <text font="3" height="12" left="475" textpieces="0" top="946" width="288">Figure 1(a), which also shape the theme of this paper.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="961" width="345">First, this result shows the classic sub-linear parallel speedup</text>
2 <text font="3" height="12" left="475" textpieces="0" top="977" width="359">phenomenon; namely, given a xed problem size, increasing the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="993" width="358">computing resources by a factor of X provides less than an X</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1008" width="359">times increase in performance [12]. Or, conversely, decreasing the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1024" width="359">resources to 1/X, results in a relative performance greater than</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1039" width="359">1/X. We can observe this phenomenon in Figure 1(a) because</text>
2 <text font="5" height="8" left="477" textpieces="0" top="1064" width="289">1Here performance is the inverse of the query response time.</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="3" height="12" left="81" textpieces="0" top="87" width="360">reducing the cluster size from 16 nodes (16N) to eight nodes (8N),</text>
2 <text font="3" height="12" left="81" textpieces="0" top="102" width="359">results in a performance ratio greater than 50%. Note that since</text>
2 <text font="3" height="12" left="81" textpieces="0" top="118" width="359">performance is the inverse of the response time, a performance ratio</text>
2 <text font="3" height="12" left="81" textpieces="0" top="134" width="359">greater than 50% at 8N means that the response time at 16N is more</text>
2 <text font="3" height="12" left="81" textpieces="0" top="149" width="318">than half the response time at 8N (i.e., sub-linear speedup).</text>
2 <text font="3" height="12" left="94" textpieces="0" top="165" width="345">Second, as shown by the solid curve in Figure 1(a), the total</text>
2 <text font="3" height="12" left="81" textpieces="0" top="181" width="359">energy required to execute the query decreases as we reduce the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="196" width="361">cluster size from 16N, even though it takes longer to run the query.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="212" width="359">Recall that energy is a product of the average power drawn by the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="228" width="359">cluster and the response time of the query. Due to the sub-linear</text>
2 <text font="3" height="12" left="81" textpieces="0" top="243" width="359">speedup, going from 16N to 8N reduces the performance by only</text>
2 <text font="3" height="12" left="81" textpieces="0" top="259" width="359">36%, but the average power drops by roughly half (since we have</text>
2 <text font="3" height="12" left="81" textpieces="0" top="275" width="359">half the number of nodes). Consequently, the energy consumption</text>
2 <text font="3" height="12" left="81" textpieces="0" top="291" width="359">ratio (relative to the 16N case) for fewer than 16 nodes is less than</text>
2 <text font="3" height="12" left="80" textpieces="0" top="306" width="360">1.0. This is an encouraging energy efciency gain, albeit at the cost</text>
2 <text font="3" height="12" left="81" textpieces="0" top="322" width="180">of increased query response time.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="338" width="345">Lastly, in Figure 1(a), the dotted line shows the line where the</text>
2 <text font="3" height="12" left="80" textpieces="1" top="353" width="362">Energy Delay Product(EDP) is constant, relative to the 16N case.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="369" width="360">EDP is dened as energy  delay (measured in Joules seconds),</text>
2 <text font="3" height="12" left="81" textpieces="0" top="385" width="359">and is commonly used in the architecture community as a way</text>
2 <text font="3" height="12" left="81" textpieces="0" top="400" width="358">of studying designs that trade-off energy for performance2. Here</text>
2 <text font="3" height="12" left="79" textpieces="0" top="416" width="360">energy refers to the query energy consumption and delay refers</text>
2 <text font="3" height="12" left="81" textpieces="0" top="432" width="359">to the query response time. A constant EDP means that we have</text>
2 <text font="3" height="12" left="81" textpieces="0" top="447" width="361">traded x% of performance for an x% drop in energy consumption.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="463" width="359">Preferably, it would be nice to identify design points that lie below</text>
2 <text font="3" height="12" left="81" textpieces="0" top="479" width="359">the EDP curve, as such points represent trading proportionally less</text>
2 <text font="3" height="12" left="81" textpieces="0" top="494" width="214">performance for greater energy savings.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="510" width="346">In Figure 1(a), all the actual data/design points (on the solid line)</text>
2 <text font="3" height="12" left="81" textpieces="0" top="526" width="359">are above the EDP curve. In other words, as we reduce the cluster</text>
2 <text font="3" height="12" left="81" textpieces="0" top="542" width="359">size from 16 nodes to 8 nodes, we are giving up proportionately more</text>
2 <text font="3" height="12" left="81" textpieces="0" top="557" width="360">performance than we are gaining in energy efciency. For example,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="573" width="359">the 10 node conguration (10N) pays a 24% penalty in performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="589" width="359">for a 16% decrease in energy consumption over the 16N case. Such</text>
2 <text font="3" height="12" left="81" textpieces="0" top="604" width="359">trade-offs may or may not be reasonable depending on the tolerance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="620" width="359">for performance penalties, but the EDP curve makes it clear in which</text>
2 <text font="3" height="12" left="81" textpieces="0" top="636" width="359">directions the trade-offs are skewed. This observation motivates</text>
2 <text font="3" height="12" left="81" textpieces="1" top="651" width="358">the key question that is addressed in this paper:  What are the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="667" width="359">key factors to consider when we design an energy-efcient DBMS</text>
2 <text font="3" height="12" left="81" textpieces="0" top="683" width="359">cluster so that we can favorably trade less performance for more</text>
2 <text font="3" height="12" left="81" textpieces="0" top="699" width="253">energy savings (i.e., lie below the EDP curve)?</text>
2 <text font="3" height="12" left="94" textpieces="0" top="714" width="345">To understand the reasons why our observed data points lie above</text>
2 <text font="3" height="12" left="81" textpieces="0" top="730" width="359">the EDP curve in Figure 1(a), and to carefully study the conditions</text>
2 <text font="3" height="12" left="81" textpieces="0" top="746" width="359">that can produce design points that lie below the EDP curve, we built</text>
2 <text font="3" height="12" left="81" textpieces="0" top="761" width="361">and modeled a custom parallel data execution kernel called P-store.</text>
2 <text font="3" height="12" left="80" textpieces="0" top="777" width="359">The data that we collected from real parallel DBMSs was used to</text>
2 <text font="3" height="12" left="80" textpieces="0" top="793" width="359">validate the performance and energy model of P-store (see Section 4</text>
2 <text font="3" height="12" left="81" textpieces="0" top="808" width="359">for details). Then, using P-store, we systematically explored both</text>
2 <text font="3" height="12" left="81" textpieces="0" top="824" width="359">the query parameters and the cluster design space parameters to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="840" width="359">examine their impact on performance and energy efciency. We</text>
2 <text font="3" height="12" left="81" textpieces="0" top="855" width="359">also developed an analytical model that allows us to further explore</text>
2 <text font="3" height="12" left="81" textpieces="0" top="871" width="92">the design space.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="887" width="345">One of the interesting insights we found using both P-store and</text>
2 <text font="3" height="12" left="81" textpieces="0" top="902" width="359">our analytical model is that there are query scenarios where certain</text>
2 <text font="3" height="12" left="81" textpieces="0" top="918" width="359">design points lie below the EDP curve. One such result is shown</text>
2 <text font="3" height="12" left="81" textpieces="0" top="934" width="359">in Figure 1(b). Here, we use our analytical model to show the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="950" width="359">energy versus performance trade-off for various eight node cluster</text>
2 <text font="3" height="12" left="81" textpieces="2" top="965" width="358">designs, when performing a join between the TPC-HLINEITEMand</text>
2 <text font="3" height="12" left="81" textpieces="2" top="981" width="358">theORDERStables (see Section 5 for details). In this gure, similar</text>
2 <text font="3" height="12" left="81" textpieces="0" top="997" width="359">to Figure 1(a), we plot the relative energy consumed by the system</text>
2 <text font="5" height="8" left="82" textpieces="0" top="1024" width="356">2With the growing viewpoint of considering an entire cluster as a single</text>
2 <text font="8" height="11" left="81" textpieces="0" top="1041" width="359">computer [10], EDP is also a useful way of thinking about the interactions</text>
2 <text font="8" height="11" left="81" textpieces="0" top="1054" width="361">between energy consumption and performance when designing data cen-</text>
2 <text font="8" height="11" left="81" textpieces="0" top="1068" width="60">ters [22, 38].</text>
=============================== COL ===================================
2 <text font="3" height="12" left="475" textpieces="0" top="87" width="359">and the response time against a reference point of an eight node</text>
2 <text font="3" height="12" left="475" textpieces="0" top="102" width="359">Xeon-based (Beefy) cluster. We then gradually replaced these</text>
2 <text font="3" height="12" left="475" textpieces="1" top="118" width="359">nodes with mobile Intel i7 based laptops (Wimpy)3nodes. The</text>
2 <text font="3" height="12" left="475" textpieces="0" top="134" width="359">Wimpy nodes do not have enough memory to build in-memory hash</text>
2 <text font="3" height="12" left="475" textpieces="0" top="149" width="359">tables for the join, and so they only scan and lter the table data</text>
2 <text font="3" height="12" left="475" textpieces="0" top="165" width="359">before shufing them off to the Beefy nodes (where the actual join</text>
2 <text font="3" height="12" left="475" textpieces="0" top="181" width="359">is performed). As opposed to Figure 1(a), which is an experiment</text>
2 <text font="3" height="12" left="475" textpieces="0" top="196" width="359">done with homogeneous Beefy nodes, Figure 1(b) shows data points</text>
2 <text font="3" height="12" left="475" textpieces="0" top="212" width="359">below the EDP curve. This result is interesting as it shows that it is</text>
2 <text font="3" height="12" left="475" textpieces="0" top="228" width="359">possible to achieve a relatively greater energy savings than response</text>
2 <text font="3" height="12" left="475" textpieces="0" top="243" width="359">time penalty (to lower the EDP) when considering alternative cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="259" width="44">designs.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="275" width="345">Energy-efcient cluster design with potentially heterogeneous</text>
2 <text font="3" height="12" left="475" textpieces="0" top="291" width="361">cluster nodes needs to be considered since non-traditional hetero-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="306" width="359">geneous clusters are now showing up as database appliances, such</text>
2 <text font="3" height="12" left="475" textpieces="0" top="322" width="361">as Oracles Exadata Database Machine [1]. Thus, to a certain ex-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="338" width="359">tent, commercial systems designers have already started down the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="353" width="361">road to heterogeneous clusters and appliances. Such considera-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="369" width="359">tions may also become important if future hardware (e.g., processor</text>
2 <text font="3" height="12" left="475" textpieces="0" top="385" width="359">and/or memory subsystems) allows systems to dynamically control</text>
2 <text font="3" height="12" left="475" textpieces="0" top="400" width="359">their power/performance trade-offs. Our paper provides a systematic</text>
2 <text font="3" height="12" left="475" textpieces="0" top="416" width="359">study of both the software and the hardware design space parameters</text>
2 <text font="3" height="12" left="475" textpieces="0" top="432" width="359">in an effort to draw conclusions about important design decisions</text>
2 <text font="3" height="12" left="475" textpieces="0" top="447" width="270">when designing energy-efcient database clusters.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="473" width="148">1.2  Contributions</text>
2 <text font="3" height="12" left="489" textpieces="0" top="496" width="347">The key contributions of this paper are: rst,we empirically ex-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="512" width="359">amine the interactions between the scalability of parallel DBMSs</text>
2 <text font="3" height="12" left="475" textpieces="0" top="527" width="360">and energy efciency. Using three DBMSs: Vertica, HadoopDB,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="543" width="359">and a custom-built parallel data processing kernel, we explore the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="559" width="359">trade-offs in performance versus energy efciency when performing</text>
2 <text font="3" height="12" left="475" textpieces="0" top="574" width="359">speedup experiments on TPC-H queries (e.g., Figure 1(a)). From</text>
2 <text font="3" height="12" left="475" textpieces="0" top="590" width="359">these results, we identify distinct bottlenecks for performance and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="606" width="359">energy efciency that should be avoided for energy-efcient cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="621" width="38">design.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="637" width="345">Second, non-traditional/wimpy low-power server hardware has</text>
2 <text font="3" height="12" left="475" textpieces="0" top="653" width="359">been evaluated for its performance/energy-efciency trade-offs, and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="668" width="360">we leverage these insights along with our own energy-efciency</text>
2 <text font="3" height="12" left="475" textpieces="0" top="684" width="359">micro-benchmarks to explore the design space for parallel DBMS</text>
2 <text font="3" height="12" left="475" textpieces="0" top="700" width="359">clusters. Using P-store, we provide a model that takes into account</text>
2 <text font="3" height="12" left="475" textpieces="0" top="716" width="359">these different server congurations and the parallel data processing</text>
2 <text font="3" height="12" left="475" textpieces="0" top="731" width="359">bottlenecks, and predicts data processing performance and energy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="747" width="339">efciency for various node congurations of a database cluster.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="763" width="345">Third, using our model we study the design space for parallel</text>
2 <text font="3" height="12" left="475" textpieces="0" top="778" width="359">DBMS clusters, and illustrate interesting cluster design points, under</text>
2 <text font="3" height="12" left="475" textpieces="0" top="794" width="360">varying query parameters for a typical hash join (e.g., Figure 1(b)).</text>
2 <text font="3" height="12" left="489" textpieces="0" top="810" width="347">Finally, we organize the insights from this study as (initial) guid-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="825" width="348">ing principles for energy-efcient data processing cluster design.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="841" width="345">The remainder of this paper is organized as follows: Section 2</text>
2 <text font="3" height="12" left="475" textpieces="0" top="857" width="361">contains background discussion and related work; Section 3 dis-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="872" width="359">cusses our ndings with Vertica and HadoopDB. In Section 4 we</text>
2 <text font="3" height="12" left="475" textpieces="0" top="888" width="359">present P-store. In Section 5, we model P-store and use the model to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="904" width="359">explore interesting cluster design points. Section 6 summarizes our</text>
2 <text font="3" height="12" left="475" textpieces="0" top="919" width="359">ndings as guiding principles for energy-efcient data processing</text>
2 <text font="3" height="12" left="475" textpieces="0" top="935" width="334">cluster design. We make our concluding remarks in Section 7.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="970" width="357">2.  BACKGROUND AND RELATED WORK</text>
2 <text font="3" height="12" left="489" textpieces="0" top="993" width="345">With recent improvements in power delivery, cooling and heat</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1009" width="359">extraction, signicant improvements have been made in improving</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1025" width="360">the energy efciency of large data centers [13]. At the server level,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1040" width="359">there are two ways to improve efciency. One is to consolidate work</text>
2 <text font="5" height="8" left="477" textpieces="0" top="1064" width="349">3We use the term wimpy as in [37], i.e. slower but [energy] efcient.</text>
=============================== PAGE ===================================
=============================== COL ===================================
1 <text font="8" height="11" left="100" textpieces="3" top="83" width="277">DBMS      Vertica                      RAM      48GB</text>
1 <text font="8" height="11" left="98" textpieces="3" top="96" width="296"># nodes     16                          Disks      8x300GB</text>
1 <text font="8" height="11" left="89" textpieces="3" top="110" width="288">TPC-H size   1TB (scale 1000)         Network    1Gb/s</text>
1 <text font="8" height="11" left="105" textpieces="3" top="124" width="318">CPU       Intel X5550 2 sockets    SysPower   130.03C0.2369</text>
1 <text font="6" height="9" left="348" textpieces="0" top="138" width="83">C = CPU utilization</text>
2 <text font="3" height="12" left="165" textpieces="0" top="156" width="191">Table 1: Cluster-V Conguration</text>
2 <text font="3" height="12" left="81" textpieces="0" top="183" width="360">onto few servers and turn off unused servers [23, 24, 27]. However,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="199" width="359">switching servers on and off has direct costs such as increased</text>
2 <text font="3" height="12" left="81" textpieces="0" top="215" width="359">query latency and decreased hardware reliability. Another approach</text>
2 <text font="3" height="12" left="81" textpieces="0" top="230" width="359">is to consolidate the server use for a given task, and improve the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="246" width="359">scheduling and the physical design to use the remaining servers</text>
2 <text font="3" height="12" left="81" textpieces="0" top="262" width="359">for other tasks. In this paper, we tackle the latter issue to explore</text>
2 <text font="3" height="12" left="81" textpieces="0" top="277" width="166">energy-efcient cluster design.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="293" width="347">There has been a growing number of efforts to improve the en-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="309" width="359">ergy efciency of clusters [710, 20, 2325, 27, 32, 34, 36]. We</text>
2 <text font="3" height="12" left="81" textpieces="0" top="324" width="359">have seen holistic redesigns that treat a data center as a single</text>
2 <text font="3" height="12" left="81" textpieces="0" top="340" width="361">computer [9, 10, 32], and approaches that consider workload consol-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="356" width="359">idation techniques in order to meet the power constraints and reduce</text>
2 <text font="3" height="12" left="81" textpieces="0" top="371" width="361">the energy requirements of clusters [7, 23, 24, 27, 34]. In data ana-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="387" width="359">lytics environments, delaying execution of workloads (increasing</text>
2 <text font="3" height="12" left="81" textpieces="0" top="403" width="361">response time) due to energy concerns have been proposed [20, 23].</text>
2 <text font="3" height="12" left="94" textpieces="0" top="419" width="345">A number of studies have also considered the use of low-power</text>
2 <text font="3" height="12" left="80" textpieces="0" top="434" width="361">(wimpy) nodes consisting of low-power storage (SSDs) and pro-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="450" width="361">cessors (mobile CPUs) [8, 17, 25, 26, 33, 36]. Primarily, these de-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="466" width="359">signs target computationally simple data processing tasks that are</text>
2 <text font="3" height="12" left="81" textpieces="0" top="481" width="361">partitionable, such as key-value workloads [37]. For such work-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="497" width="359">loads, wimpy node clusters are more energy efcient compared to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="513" width="361">traditional clusters built using more power-hungry beefy nodes.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="528" width="359">But, for analytical database workloads that often exhibit non-linear</text>
2 <text font="3" height="12" left="81" textpieces="0" top="544" width="359">speedup, and especially when the network is a bottleneck, it was</text>
2 <text font="3" height="12" left="81" textpieces="0" top="560" width="361">shown that such wimpy node clusters often increase the total operat-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="575" width="360">ing costs [25]. Alternatively, servers can be augmented with custom,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="591" width="361">low-power circuitry, like Field-Programmable Gate Arrays [2, 29].</text>
2 <text font="3" height="12" left="81" textpieces="0" top="607" width="359">Such approaches are complementary to our study of heterogeneous</text>
2 <text font="3" height="12" left="81" textpieces="0" top="623" width="336">cluster design, and are an interesting direction for future work.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="638" width="347">Early database research studies speculated that the database soft-</text>
2 <text font="3" height="12" left="80" textpieces="0" top="654" width="361">ware has an important role to play in improving the energy efciency,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="670" width="359">and argued for the redesign of several key components such as the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="685" width="361">query optimizer, the workload manager, the scheduler and the physi-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="701" width="359">cal database design [14, 18, 22]. Many of these suggestions assumed</text>
2 <text font="3" height="12" left="81" textpieces="0" top="717" width="359">that, like cars, computer systems have different optimal performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="732" width="361">and energy efciency points. However, only preliminary experimen-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="748" width="245">tal data was provided to support these claims.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="764" width="345">Subsequent efforts have studied how alternate database designs</text>
2 <text font="3" height="12" left="81" textpieces="0" top="779" width="360">and congurations can improve the energy efciency of a DBMS [21,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="795" width="359">35, 38]. Meza et al. [28], have studied the energy efciency of</text>
2 <text font="3" height="12" left="81" textpieces="0" top="811" width="359">a scale-up enterprise decision support system, and showed that</text>
2 <text font="3" height="12" left="81" textpieces="0" top="827" width="359">the most energy-efcient conguration was not always the fastest</text>
2 <text font="3" height="12" left="81" textpieces="0" top="842" width="359">depending on the degree of declustering across disks. Lang et</text>
2 <text font="3" height="12" left="81" textpieces="0" top="858" width="359">al. [24], showed how data replication can be leveraged to reduce</text>
2 <text font="3" height="12" left="81" textpieces="0" top="874" width="359">the number of online cluster nodes in a parallel DBMS. That work</text>
2 <text font="3" height="12" left="81" textpieces="0" top="889" width="359">is complimentary to ours as we could leverage similar replication</text>
2 <text font="3" height="12" left="81" textpieces="0" top="905" width="360">techniques to dynamically augment cluster size. Chen et al. [11],</text>
2 <text font="3" height="12" left="81" textpieces="0" top="921" width="359">considered heterogeneous usage of MapReduce servers through a</text>
2 <text font="3" height="12" left="81" textpieces="0" top="936" width="359">software workload manager. In contrast, we consider heterogeneity</text>
2 <text font="3" height="12" left="81" textpieces="0" top="952" width="355">in the cluster servers as well as the execution paths across servers.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="997" width="324">3.  PARALLEL DATABASE BEHAVIOR</text>
2 <text font="3" height="12" left="94" textpieces="0" top="1020" width="345">In this section we examine the performance behavior and speedup</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1035" width="359">in shared-nothing DBMS clusters, and examine its effect on energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1051" width="359">efciency. We see that bottlenecks that degrade performance, like</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1067" width="359">network bottlenecks, decrease the energy efciency of a cluster</text>
=============================== COL ===================================
2 <text font="4" height="10" left="650" textpieces="0" top="266" width="2"> </text>
2 <text font="5" height="9" left="614" textpieces="2" top="126" width="-39">8N              10N                12N </text>
2 <text font="5" height="9" left="529" textpieces="1" top="130" width="-9">14N               16N </text>
2 <text font="5" height="9" left="491" textpieces="0" top="240" width="11">0.0</text>
2 <text font="5" height="9" left="491" textpieces="0" top="220" width="11">0.2</text>
2 <text font="5" height="9" left="491" textpieces="0" top="201" width="11">0.4</text>
2 <text font="5" height="9" left="491" textpieces="0" top="181" width="11">0.6</text>
2 <text font="5" height="9" left="491" textpieces="0" top="162" width="11">0.8</text>
2 <text font="5" height="9" left="491" textpieces="0" top="142" width="11">1.0</text>
2 <text font="5" height="9" left="491" textpieces="0" top="123" width="11">1.2</text>
2 <text font="5" height="9" left="491" textpieces="0" top="103" width="11">1.4</text>
2 <text font="5" height="9" left="629" textpieces="3" top="251" width="-110">0.40                   0.60                   0.80                   1.00</text>
2 <text font="6" height="11" left="483" textpieces="0" top="241" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="512" textpieces="0" top="261" width="111">Normalized Performance </text>
2 <text font="7" height="13" left="511" textpieces="0" top="85" width="96">Vertica - TPC-H Q1 </text>
2 <text font="4" height="10" left="830" textpieces="0" top="266" width="2"> </text>
2 <text font="5" height="9" left="794" textpieces="1" top="127" width="-11">8N              10N </text>
2 <text font="5" height="9" left="732" textpieces="2" top="133" width="-32">12N                14N             16N </text>
2 <text font="5" height="9" left="671" textpieces="0" top="240" width="11">0.0</text>
2 <text font="5" height="9" left="671" textpieces="0" top="220" width="11">0.2</text>
2 <text font="5" height="9" left="671" textpieces="0" top="201" width="11">0.4</text>
2 <text font="5" height="9" left="671" textpieces="0" top="181" width="11">0.6</text>
2 <text font="5" height="9" left="671" textpieces="0" top="162" width="11">0.8</text>
2 <text font="5" height="9" left="671" textpieces="0" top="142" width="11">1.0</text>
2 <text font="5" height="9" left="671" textpieces="0" top="123" width="11">1.2</text>
2 <text font="5" height="9" left="671" textpieces="0" top="103" width="11">1.4</text>
2 <text font="5" height="9" left="809" textpieces="3" top="251" width="-110">0.40                   0.60                   0.80                   1.00</text>
2 <text font="6" height="11" left="663" textpieces="0" top="240" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="692" textpieces="0" top="261" width="111">Normalized Performance </text>
2 <text font="7" height="13" left="691" textpieces="0" top="85" width="102">Vertica - TPC-H Q21 </text>
2 <text font="3" height="12" left="561" textpieces="1" top="280" width="188">(a)                            (b)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="298" width="361">Figure 2: Vertica TPC-H (a) Q1, (b) Q21 (scale 1000) empiri-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="314" width="359">cal parallel speedup results and its effect on energy efciency</text>
2 <text font="3" height="12" left="475" textpieces="0" top="329" width="361">under various cluster sizes. Cluster details can be found in Ta-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="345" width="359">ble 1. The dotted line indicates trading a proportional decrease</text>
2 <text font="3" height="12" left="475" textpieces="0" top="361" width="359">in performance for a decrease in energy consumed such that</text>
2 <text font="3" height="12" left="475" textpieces="0" top="377" width="275">the EDP (= energy  delay) metric is constant.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="406" width="361">design. We experiment with two off-the-shelf, column-oriented, par-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="422" width="361">allel DBMSs, Vertica [3] and HadoopDB [6] (with Vectorwise [4]).</text>
2 <text font="3" height="12" left="475" textpieces="0" top="437" width="359">Vertica was deployed on cluster-V (see Table 1), and we used queries</text>
2 <text font="3" height="12" left="475" textpieces="0" top="453" width="263">from the TPC-H benchmark at scale factor 1000.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="479" width="96">3.1  Vertica</text>
2 <text font="3" height="12" left="489" textpieces="0" top="502" width="345">We used Vertica v.4.0.12-0 64 bit RHEL5 running on 16 HP</text>
2 <text font="3" height="12" left="475" textpieces="0" top="518" width="359">ProLiant DL360G6 servers (the cluster conguration is described</text>
2 <text font="3" height="12" left="475" textpieces="0" top="533" width="359">in Table 1), varying the cluster size between 8 and 16 nodes, in 2</text>
2 <text font="3" height="12" left="475" textpieces="0" top="549" width="361">node increments. We only present results with a warm buffer pool.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="565" width="359">Given the use of column-store in Vertica, the working sets for all</text>
2 <text font="3" height="12" left="475" textpieces="0" top="580" width="306">the queries t in main memory (even in the 8 node case).</text>
2 <text font="3" height="12" left="489" textpieces="0" top="596" width="345">We did not have physical access to our clusters so we used real</text>
2 <text font="3" height="12" left="475" textpieces="0" top="612" width="359">power readings from the iLO2 remote management interface [5] to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="627" width="359">develop server power models based on CPU utilization, following</text>
2 <text font="3" height="12" left="475" textpieces="0" top="643" width="359">an approach that has been used before [34]. Using a single cluster-V</text>
2 <text font="3" height="12" left="475" textpieces="0" top="659" width="360">node, we used a custom parallel hash-join program (see Section 4)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="675" width="359">to generate CPU load, and iLO2 measured the reported power drawn</text>
2 <text font="3" height="12" left="475" textpieces="0" top="690" width="359">by the node usage. We varied the number of concurrent joins to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="706" width="359">control the utilization on the nodes. iLO2 reports measurements</text>
2 <text font="3" height="12" left="475" textpieces="0" top="722" width="359">averaged over a 5 minute window, and we ran the experiments for</text>
2 <text font="3" height="12" left="475" textpieces="0" top="737" width="359">three 5 minute windows for each CPU utilization measurement. The</text>
2 <text font="3" height="12" left="475" textpieces="0" top="753" width="359">power readings at each CPU utilization level were stable, and we use</text>
2 <text font="3" height="12" left="475" textpieces="0" top="769" width="361">the average of the three readings to create our server power models.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="784" width="361">(Our measurements of physically accessible servers, not using iLO2,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="800" width="359">in Section 5 produced similar models.) In the interest of space, we</text>
2 <text font="3" height="12" left="475" textpieces="0" top="816" width="359">omit the measured results but show the derived power models in</text>
2 <text font="3" height="12" left="475" textpieces="0" top="831" width="361">Table 1 as SysPower. (In this paper, we explored exponential,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="847" width="359">power, and logarithmic regression models, and picked the one with</text>
2 <text font="3" height="12" left="475" textpieces="1" top="863" width="102">the best R2value.)</text>
2 <text font="3" height="12" left="489" textpieces="0" top="879" width="345">We employed Verticas hash segmentation capability which hash</text>
2 <text font="3" height="12" left="475" textpieces="0" top="894" width="361">partitions a table across the cluster nodes on a user-dened attribute.</text>
2 <text font="3" height="12" left="475" textpieces="4" top="910" width="358">We partitioned theLINEITEM,ORDERS, andCUSTOMERtables using</text>
2 <text font="3" height="12" left="475" textpieces="0" top="926" width="359">the hash segmentation, while all the remaining TPC-H tables were</text>
2 <text font="3" height="12" left="475" textpieces="4" top="941" width="359">replicated on each node. TheORDERSand theCUSTOMERtables</text>
2 <text font="3" height="12" left="475" textpieces="4" top="957" width="361">were hashed on theO CUSTKEYandC CUSTKEYattributes respec-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="359">tively, so that a join between these two tables does not require any</text>
2 <text font="3" height="12" left="475" textpieces="1" top="988" width="358">shufing/partitioning of the input tables on-the-y. TheLINEITEM</text>
2 <text font="3" height="12" left="475" textpieces="2" top="1004" width="250">table was hashed on theL ORDERKEYattribute.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1020" width="345">We ran a number of TPC-H queries and present a selection of our</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="359">results in this section. In Figure 2(a) we show the energy consumed</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1051" width="359">and performance (i.e., the inverse of the query response time) for</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">various cluster sizes running the TPC-H Query 1. This query does</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="3" height="12" left="81" textpieces="0" top="87" width="359">not involve any joins and only does simple aggregations on the</text>
2 <text font="6" height="9" left="81" textpieces="1" top="104" width="358">LINEITEM table. The data points are shown relative to the largest</text>
2 <text font="3" height="12" left="81" textpieces="0" top="118" width="359">cluster size of 16 nodes, and the break-even EDP line is also</text>
2 <text font="3" height="12" left="81" textpieces="0" top="134" width="360">plotted, as was also done earlier in Figure 1(a). Recall from Section 1</text>
2 <text font="3" height="12" left="81" textpieces="0" top="149" width="359">that this dotted line represents data points that trade energy savings</text>
2 <text font="3" height="12" left="81" textpieces="0" top="165" width="337">for a performance penalty such that the EDP remains constant.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="181" width="347">In Figure 2(a), we observe that Verticas performance scales lin-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="196" width="359">early, as the 8 node cluster has a performance ratio of about 0.5</text>
2 <text font="3" height="12" left="81" textpieces="0" top="212" width="361">compared to the 16 node case. Consequently, the energy consump-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="228" width="359">tion ratio is fairly constant since the 50% performance degradation</text>
2 <text font="3" height="12" left="81" textpieces="0" top="243" width="359">is offset by a 50% drop in average cluster power. This result is</text>
2 <text font="3" height="12" left="81" textpieces="0" top="259" width="359">important because it shows that a partitionable analytics workload</text>
2 <text font="3" height="12" left="80" textpieces="0" top="275" width="359">(like TPC-H Query 1), exhibits ideal speedup as we allocate more</text>
2 <text font="3" height="12" left="81" textpieces="0" top="291" width="359">nodes to the cluster. Thus the energy consumption will remain</text>
2 <text font="3" height="12" left="81" textpieces="0" top="306" width="359">roughly constant as we change the cluster size. In other words, one</text>
2 <text font="3" height="12" left="81" textpieces="0" top="322" width="359">interesting energy-efcient design point is to simply provision as</text>
2 <text font="3" height="12" left="81" textpieces="0" top="338" width="359">many nodes as possible for this type of query (as there is no change</text>
2 <text font="3" height="12" left="81" textpieces="0" top="353" width="321">in energy consumption, but there is a performance penalty).</text>
2 <text font="3" height="12" left="94" textpieces="0" top="369" width="345">Let us consider a more complex query. Figure 2(b) shows the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="385" width="359">results for TPC-H Query 21, which is a query that involves a join</text>
2 <text font="3" height="12" left="81" textpieces="4" top="400" width="359">across four tables:SUPPLIER,LINEITEM,ORDERS, andNATION. The</text>
2 <text font="6" height="9" left="81" textpieces="3" top="418" width="359">SUPPLIERand NATIONtables were replicated across all the nodes, so</text>
2 <text font="3" height="12" left="81" textpieces="4" top="432" width="358">only the join between theLINEITEMand theORDERStables on the</text>
2 <text font="6" height="9" left="81" textpieces="3" top="449" width="359">ORDERKEYattribute required repartitioning (of theORDERS table on</text>
2 <text font="6" height="9" left="81" textpieces="0" top="465" width="358">O ORDERKEY). Besides the four table join, Query 21 also contains</text>
2 <text font="6" height="9" left="81" textpieces="5" top="481" width="356">SELECTsubqueries on the LINEITEM table within theWHEREclause.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="494" width="346">Surprisingly, the results for the more complex TPC-H Query</text>
2 <text font="3" height="12" left="81" textpieces="0" top="510" width="359">21 results, shown in Figure 2(b), is similar to that of the simpler</text>
2 <text font="3" height="12" left="80" textpieces="0" top="526" width="359">TPC-H Query 1, which is shown in Figure 2(a). Since both queries</text>
2 <text font="3" height="12" left="81" textpieces="0" top="542" width="359">scale well, the energy consumption is fairly at in both cases. It</text>
2 <text font="3" height="12" left="81" textpieces="0" top="557" width="360">is interesting to consider why the more complex TPC-H Query 21</text>
2 <text font="3" height="12" left="81" textpieces="1" top="573" width="358">scales well, even though it requires a repartitioning of theORDERS</text>
2 <text font="3" height="12" left="81" textpieces="0" top="589" width="359">table during query processing. The reason for this behavior is that</text>
2 <text font="3" height="12" left="81" textpieces="0" top="604" width="359">the bulk of this query (94.5% of the total query time for eight nodes</text>
2 <text font="3" height="12" left="79" textpieces="0" top="620" width="361"> 8N) is spent doing node local execution. Only 5.5% of the total</text>
2 <text font="3" height="12" left="81" textpieces="4" top="636" width="361">query time is spent repartitioning for theLINEITEMandORDERSjoin.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="651" width="359">Since the bulk of the query is processed locally on each node, this</text>
2 <text font="3" height="12" left="81" textpieces="0" top="667" width="359">means that increasing the cluster size increases performance nearly</text>
2 <text font="3" height="12" left="81" textpieces="0" top="683" width="359">linearly. Thus, for a query with few bottlenecks, Vertica exhibits</text>
2 <text font="3" height="12" left="81" textpieces="0" top="698" width="359">nearly ideal speedup, and so the energy-efcient cluster design is to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="714" width="206">simply use as many nodes as possible.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="730" width="345">However, we have already seen a complex query where Vertica</text>
2 <text font="3" height="12" left="81" textpieces="1" top="746" width="358">does notexhibit ideal speedup. Compare the TPC-H Query 21 result</text>
2 <text font="3" height="12" left="81" textpieces="0" top="761" width="359">to Query 12 (shown in Section 1, Figure 1(a)), which is a much</text>
2 <text font="3" height="12" left="81" textpieces="4" top="777" width="360">simpler two table join between theORDERSand theLINEITEMtables,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="793" width="359">and performs the same repartitioning as Query 21. Compared to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="808" width="359">the 5.5% time spent network bottlenecked during repartitioning</text>
2 <text font="3" height="12" left="81" textpieces="0" top="824" width="359">in Query 21, Query 12 spends 48% of the query time network</text>
2 <text font="3" height="12" left="81" textpieces="0" top="840" width="359">bottlenecked during repartitioning with the eight node cluster. Since</text>
2 <text font="3" height="12" left="81" textpieces="0" top="855" width="359">the proportional amount of total query time spent doing node local</text>
2 <text font="3" height="12" left="81" textpieces="0" top="871" width="359">processing is now dramatically reduced, we see in Figure 1(a), that</text>
2 <text font="3" height="12" left="81" textpieces="0" top="887" width="359">increasing the cluster size does not result in a proportional increase</text>
2 <text font="3" height="12" left="81" textpieces="0" top="902" width="359">in performance. As such, the energy efciency suffers dramatically</text>
2 <text font="3" height="12" left="81" textpieces="0" top="918" width="269">as we increase the cluster size from 8 to 16 nodes.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="934" width="345">Summary: Our Vertica results show that for queries that do</text>
2 <text font="3" height="12" left="81" textpieces="0" top="950" width="359">not involve signicant time repartitioning (i.e., most of the query</text>
2 <text font="3" height="12" left="81" textpieces="0" top="965" width="359">execution time is spent on local computation at each node), the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="981" width="359">energy consumption vs. performance curves are roughly at. This</text>
2 <text font="3" height="12" left="81" textpieces="0" top="997" width="359">implies that an interesting point for energy-efcient cluster design</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1012" width="359">is to pick a cluster that is as large as possible, as there is no energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1028" width="359">savings when using fewer nodes, but there is an increase in query</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1044" width="359">response time. However, for queries that are bottlenecked, as we</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1059" width="359">saw with TPC-H Q12s network repartitioning, non-linear speedup</text>
=============================== COL ===================================
2 <text font="3" height="12" left="475" textpieces="0" top="87" width="359">means that a potential energy-efcient design decision is to reduce</text>
2 <text font="3" height="12" left="475" textpieces="0" top="102" width="359">the cluster size up to the point where the lower performance is</text>
2 <text font="3" height="12" left="475" textpieces="0" top="118" width="358">acceptable4. Of course, one simple way to mitigate repartitioning</text>
2 <text font="3" height="12" left="475" textpieces="0" top="134" width="359">bottlenecks is to devise energy-aware repartitioning or replication</text>
2 <text font="3" height="12" left="475" textpieces="0" top="149" width="359">strategies. An analysis and comparison to such strategies is beyond</text>
2 <text font="3" height="12" left="475" textpieces="0" top="165" width="338">the scope of this paper, but an interesting target of future work.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="190" width="127">3.2  HadoopDB</text>
2 <text font="3" height="12" left="489" textpieces="0" top="213" width="345">HadoopDB is an open-source, shared-nothing parallel DBMS</text>
2 <text font="3" height="12" left="475" textpieces="0" top="229" width="359">that uses Hadoop to coordinate independent nodes, with each node</text>
2 <text font="3" height="12" left="475" textpieces="0" top="244" width="359">running Ingres/VectorWise [4, 6]. We used Hadoop ver. 0.19.2 and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="260" width="359">Ingres VectorWise ver. 1.0.0-112. Setup scripts for HadoopDB and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="276" width="337">the TPC-H queries we ran were provided by the authors of [6].</text>
2 <text font="3" height="12" left="489" textpieces="0" top="291" width="347">In HadoopDB, Hadoop acts as a means of communication be-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="307" width="359">tween the individual nodes. However, Hadoop was designed with</text>
2 <text font="3" height="12" left="475" textpieces="0" top="323" width="361">fault tolerance as one of the primary goals and consequently, the per-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="338" width="359">formance of our version of HadoopDB was limited by the Hadoop</text>
2 <text font="3" height="12" left="475" textpieces="0" top="354" width="359">bottleneck. Our evaluation of HadoopDB found that (similar to the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="370" width="359">results in Figure 1(a)) the best performing cluster is not always the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="386" width="361">most energy-efcient. In the interest of space, we omit these results.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="411" width="122">3.3  Discussion</text>
2 <text font="3" height="12" left="489" textpieces="0" top="433" width="345">From our results with Vertica, we have found that there are queries</text>
2 <text font="3" height="12" left="475" textpieces="0" top="449" width="361">where the highest performing cluster conguration is not the most en-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="465" width="361">ergy efcient (TPC-H Q12, Figure 1(a)) due to a network bottleneck.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="481" width="360">With a commercial DBMS, simpler queries that do not require any</text>
2 <text font="3" height="12" left="475" textpieces="0" top="496" width="359">internode communication scale fairly linearly with increased cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="512" width="361">size. We saw this with Query 1 and Query 21 (Figures 2(a,b)). How-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="528" width="360">ever, with communication heavy queries such as Q12 (Figure 1(a)),</text>
2 <text font="3" height="12" left="475" textpieces="0" top="543" width="359">increasing the cluster size simply adds extra network overhead that</text>
2 <text font="3" height="12" left="475" textpieces="0" top="559" width="361">dampens the performance increase and reduces our energy savings.</text>
2 <text font="3" height="12" left="474" textpieces="0" top="575" width="359">Thus, we conclude that optimizing for parallel DBMS performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="590" width="359">does not always result in the lowest energy consumed per query and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="606" width="359">this is the opposite conclusion from prior work which dealt with</text>
2 <text font="3" height="12" left="475" textpieces="0" top="622" width="214">single server DBMS environments [35].</text>
2 <text font="3" height="12" left="489" textpieces="0" top="637" width="347">With our results, we hypothesize that queries with bottlenecks,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="653" width="360">such as the network or disk, cause node underutilization and thus,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="669" width="359">the bottlenecks decrease the energy efciency as the cluster size</text>
2 <text font="3" height="12" left="475" textpieces="0" top="684" width="359">increases. Since Vertica and HadoopDB are black-box systems, to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="700" width="361">further explore this hypothesis of performance bottlenecks affect-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="716" width="359">ing affecting energy efciency, we built a custom parallel query</text>
2 <text font="3" height="12" left="475" textpieces="0" top="732" width="359">execution engine called P-store. Using P-store we empirically and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="747" width="359">analytically studied various join operations that require varying</text>
2 <text font="3" height="12" left="475" textpieces="0" top="763" width="183">degrees of network repartitioning.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="797" width="359">4.  ENERGY EFFICIENCY OF A PARAL-</text>
2 <text font="1" height="16" left="507" textpieces="0" top="818" width="283">LEL DATA PROCESSING ENGINE</text>
2 <text font="3" height="12" left="489" textpieces="0" top="841" width="347">From our empirical, off-the-shelf, parallel DBMS observations,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="857" width="360">we concluded that the scalability of the system running a given query</text>
2 <text font="3" height="12" left="475" textpieces="0" top="872" width="359">plays an important role in inuencing the energy efciency of the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="888" width="359">cluster design points. Typically, poor scalability is a consequence of</text>
2 <text font="3" height="12" left="475" textpieces="0" top="904" width="361">bottlenecks in the system. We now describe some of these bottle-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="919" width="359">necks, and then present our custom parallel query execution engine</text>
2 <text font="3" height="12" left="475" textpieces="0" top="935" width="338">P-store that allows us to study these bottlenecks in more detail.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="960" width="130">4.1  Bottlenecks</text>
2 <text font="3" height="12" left="489" textpieces="0" top="983" width="345">Since there can be a multitude of implementation-specic issues</text>
2 <text font="3" height="12" left="475" textpieces="0" top="999" width="359">that can affect DBMS scalability, in this paper we are interested</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1014" width="361">only in fundamental bottlenecks that are inherent to the core engine.</text>
2 <text font="5" height="8" left="477" textpieces="0" top="1037" width="356">4Cluster systems often have implicit or explicit minimum performance</text>
2 <text font="8" height="11" left="475" textpieces="0" top="1054" width="359">targets for many workloads. We recognize that determining when such limits</text>
2 <text font="8" height="11" left="475" textpieces="0" top="1068" width="258">are acceptable is a broad and emerging research topic.</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="8" height="11" left="318" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="254" textpieces="0" top="111" width="17">4N </text>
2 <text font="4" height="10" left="182" textpieces="0" top="98" width="17">6N </text>
2 <text font="4" height="10" left="124" textpieces="0" top="85" width="17">8N </text>
2 <text font="4" height="10" left="104" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="104" textpieces="0" top="243" width="15">0.1</text>
2 <text font="4" height="10" left="104" textpieces="0" top="227" width="15">0.2</text>
2 <text font="4" height="10" left="104" textpieces="0" top="211" width="15">0.3</text>
2 <text font="4" height="10" left="104" textpieces="0" top="194" width="15">0.4</text>
2 <text font="4" height="10" left="104" textpieces="0" top="178" width="15">0.5</text>
2 <text font="4" height="10" left="104" textpieces="0" top="162" width="15">0.6</text>
2 <text font="4" height="10" left="104" textpieces="0" top="146" width="15">0.7</text>
2 <text font="4" height="10" left="104" textpieces="0" top="130" width="15">0.8</text>
2 <text font="4" height="10" left="104" textpieces="0" top="114" width="15">0.9</text>
2 <text font="4" height="10" left="104" textpieces="0" top="98" width="15">1.0</text>
2 <text font="4" height="10" left="290" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="94" textpieces="0" top="255" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="133" textpieces="0" top="283" width="149">Normalized Performance </text>
2 <text font="8" height="11" left="573" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="514" textpieces="0" top="135" width="17">4N </text>
2 <text font="4" height="10" left="429" textpieces="0" top="102" width="17">6N </text>
2 <text font="4" height="10" left="378" textpieces="0" top="85" width="17">8N </text>
2 <text font="4" height="10" left="358" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="358" textpieces="0" top="243" width="15">0.1</text>
2 <text font="4" height="10" left="358" textpieces="0" top="227" width="15">0.2</text>
2 <text font="4" height="10" left="358" textpieces="0" top="211" width="15">0.3</text>
2 <text font="4" height="10" left="358" textpieces="0" top="194" width="15">0.4</text>
2 <text font="4" height="10" left="358" textpieces="0" top="178" width="15">0.5</text>
2 <text font="4" height="10" left="358" textpieces="0" top="162" width="15">0.6</text>
2 <text font="4" height="10" left="358" textpieces="0" top="146" width="15">0.7</text>
2 <text font="4" height="10" left="358" textpieces="0" top="130" width="15">0.8</text>
2 <text font="4" height="10" left="358" textpieces="0" top="114" width="15">0.9</text>
2 <text font="4" height="10" left="358" textpieces="0" top="98" width="15">1.0</text>
2 <text font="4" height="10" left="544" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="348" textpieces="0" top="256" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="387" textpieces="0" top="283" width="149">Normalized Performance </text>
2 <text font="8" height="11" left="827" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="763" textpieces="0" top="139" width="17">4N </text>
2 <text font="4" height="10" left="680" textpieces="0" top="132" width="17">6N </text>
2 <text font="4" height="10" left="632" textpieces="0" top="87" width="17">8N </text>
2 <text font="4" height="10" left="613" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="613" textpieces="0" top="243" width="15">0.1</text>
2 <text font="4" height="10" left="613" textpieces="0" top="227" width="15">0.2</text>
2 <text font="4" height="10" left="613" textpieces="0" top="211" width="15">0.3</text>
2 <text font="4" height="10" left="613" textpieces="0" top="195" width="15">0.4</text>
2 <text font="4" height="10" left="613" textpieces="0" top="179" width="15">0.5</text>
2 <text font="4" height="10" left="613" textpieces="0" top="164" width="15">0.6</text>
2 <text font="4" height="10" left="613" textpieces="0" top="148" width="15">0.7</text>
2 <text font="4" height="10" left="613" textpieces="0" top="132" width="15">0.8</text>
2 <text font="4" height="10" left="613" textpieces="0" top="116" width="15">0.9</text>
2 <text font="4" height="10" left="613" textpieces="0" top="100" width="15">1.0</text>
2 <text font="4" height="10" left="799" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="602" textpieces="0" top="255" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="643" textpieces="0" top="283" width="150">Normalized Performance </text>
2 <text font="3" height="12" left="154" textpieces="2" top="300" width="642">(a) One query                            (b) Two concurrent queries                     (c) Four concurrent queries</text>
2 <text font="3" height="12" left="81" textpieces="4" top="318" width="755">Figure 3: A partition incompatible TPC-H Q3 dual shufe (exchange) hash join betweenLINEITEMandORDERS(scale 1000) in P-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="334" width="753">store. Each subgure (a-c) shows the energy consumption and performance ratios relative to the 8 node cluster reference point. The</text>
2 <text font="3" height="12" left="81" textpieces="0" top="349" width="373">dotted line indicates the points where the EDP metric is constant.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="381" width="361">Since our focus is on analytic SQL queries, we examine core par-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="396" width="359">allel database operators, such as scans, joins, and exchanges. For</text>
2 <text font="3" height="12" left="81" textpieces="0" top="412" width="359">these kinds of queries and operators we identify three categories of</text>
2 <text font="3" height="12" left="81" textpieces="0" top="428" width="359">bottlenecks that can lead to underutilized hardware components in a</text>
2 <text font="3" height="12" left="81" textpieces="0" top="443" width="110">cluster environment.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="459" width="345">Hardware bottleneck (network and disk): Decision support</text>
2 <text font="3" height="12" left="81" textpieces="0" top="475" width="361">queries often require repartitioning during query execution. Repli-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="491" width="359">cation of tables on different partition keys can alleviate the need for</text>
2 <text font="3" height="12" left="81" textpieces="0" top="506" width="359">repartitioning in some cases, but this option is limited to only small</text>
2 <text font="3" height="12" left="81" textpieces="0" top="522" width="309">tables as it is often too expensive to replicate large tables.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="538" width="346">The repartitioning step is often gated by the speed of the network</text>
2 <text font="3" height="12" left="81" textpieces="0" top="553" width="359">interconnect, causing the processor and other resources of a node to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="569" width="359">idle while the node waits for data from the network. Additionally, an</text>
2 <text font="3" height="12" left="81" textpieces="0" top="585" width="359">increase in network trafc on the cluster switches causes interference</text>
2 <text font="3" height="12" left="81" textpieces="0" top="600" width="359">and further delays in communication. Future advances in networking</text>
2 <text font="3" height="12" left="81" textpieces="0" top="616" width="359">technology are expected to be accompanied by advances in CPU</text>
2 <text font="3" height="12" left="81" textpieces="0" top="632" width="361">capabilities, making this performance gap a persistent problem [30].</text>
2 <text font="3" height="12" left="94" textpieces="0" top="647" width="345">The balance between the network and disk subsystems can be</text>
2 <text font="3" height="12" left="81" textpieces="0" top="663" width="359">easily disturbed with varying predicate selectivities which diminish</text>
2 <text font="3" height="12" left="81" textpieces="0" top="679" width="359">the rate at which the storage subsystem can deliver qualied tuples</text>
2 <text font="3" height="12" left="81" textpieces="0" top="695" width="359">to the network. As a result, underutilized CPU cores waiting to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="710" width="359">process operators at the higher levels of a query plan waste energy.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="726" width="353">Algorithmic bottleneck (broadcast): For certain joins, the cheap-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="742" width="359">est execution plan may be to broadcast a copy of the inner table</text>
2 <text font="3" height="12" left="80" textpieces="0" top="757" width="359">(once all local predicates have been applied) to all the nodes so</text>
2 <text font="3" height="12" left="81" textpieces="0" top="773" width="359">that the join is performed without re-partitioning the (potentially</text>
2 <text font="3" height="12" left="81" textpieces="0" top="789" width="359">larger) outer table. Such a broadcast generally takes the same time</text>
2 <text font="3" height="12" left="81" textpieces="0" top="804" width="360">to complete regardless of the number of participating nodes (e.g.,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="820" width="359">for mGB of qualifying tuples and say 16 nodes, each node needs to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="836" width="359">receive (15m/16)GB of the data, while for 32 nodes this changes</text>
2 <text font="3" height="12" left="81" textpieces="0" top="851" width="359">by a small amount to (31m/32)GB). As a result, scaling out to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="867" width="359">more nodes does not speed up this rst phase of a join and it reduces</text>
2 <text font="3" height="12" left="81" textpieces="0" top="883" width="154">the cluster energy efciency.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="898" width="347">Data skew: Although partitioning tools try to avoid data skew,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="914" width="359">even a small skew, can cause an imbalance in the utilization of the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="930" width="359">cluster nodes, especially as the system scales. Thus, data skew can</text>
2 <text font="3" height="12" left="81" textpieces="0" top="946" width="359">easily create cluster and server imbalances even in highly tuned</text>
2 <text font="3" height="12" left="81" textpieces="0" top="961" width="359">congurations. While we recognize data skew as a bottleneck, we</text>
2 <text font="3" height="12" left="81" textpieces="0" top="977" width="357">leave an investigation of this critical issue as a part of future work.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="1013" width="348">4.2  P-store: A Custom-built Parallel Engine</text>
2 <text font="3" height="12" left="94" textpieces="0" top="1035" width="345">P-store is built on top of a block-iterator tuple-scan module and</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1051" width="361">a storage engine [16], that has scan, project, and select operators.</text>
2 <text font="3" height="12" left="80" textpieces="0" top="1067" width="361">To this engine, we added network exchange and hash join operators.</text>
=============================== COL ===================================
2 <text font="3" height="12" left="475" textpieces="0" top="381" width="360">Since energy consumption is a function of average power and time,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="396" width="359">our goal was to make our engine perform at levels comparable to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="412" width="359">commercial systems. Therefore, it was imperative that our exchange</text>
2 <text font="3" height="12" left="475" textpieces="0" top="428" width="359">operator is able to transfer over the network at rates near the limits</text>
2 <text font="3" height="12" left="475" textpieces="0" top="443" width="359">of the physical hardware, and our operators never materialize tuples</text>
2 <text font="3" height="12" left="475" textpieces="0" top="459" width="355">while maximizing utilization through multi-threaded concurrency.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="489" width="139">4.3  Experiments</text>
2 <text font="3" height="12" left="489" textpieces="0" top="512" width="347">The purpose of these P-store experiments is to stress our work-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="528" width="359">horse exchange operator when performing partition-incompatible</text>
2 <text font="3" height="12" left="475" textpieces="0" top="543" width="359">hash joins. By stressing the exchange operator, we wanted to see</text>
2 <text font="3" height="12" left="475" textpieces="0" top="559" width="359">how the hash join operation behaves at different points in the cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="575" width="361">design space with respect to performance and energy consumption.</text>
2 <text font="3" height="12" left="489" textpieces="3" top="590" width="345">Our hash join query is between theLINEITEM and theORDERS</text>
2 <text font="3" height="12" left="475" textpieces="0" top="606" width="359">tables of TPC-H at a scale factor of 1000, similar to the Vertica</text>
2 <text font="3" height="12" left="475" textpieces="0" top="622" width="359">experiments (see Section 3.1). We used eight of the cluster-V nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="637" width="359">described in Table 1. By measuring the CPU utilization, the average</text>
2 <text font="3" height="12" left="475" textpieces="0" top="653" width="359">cluster power was found using our empirically derived model from</text>
2 <text font="3" height="12" left="475" textpieces="0" top="669" width="231">the cluster-V column of Table 1, Section 3.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="685" width="345">To explore the bottleneck of partition-incompatible joins, we</text>
2 <text font="3" height="12" left="475" textpieces="5" top="700" width="359">hash partitioned theLINEITEMandORDERStables on theirL SHIPDATE</text>
2 <text font="3" height="12" left="475" textpieces="2" top="716" width="361">andO CUSTKEYattributes respectively, and examined the join be-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="732" width="359">tween these two tables that is necessary for TPC-H Query 3. The</text>
2 <text font="6" height="9" left="475" textpieces="2" top="749" width="360">LINEITEM table is projected to the L ORDERKEY, L EXTENDEDPRICE,</text>
2 <text font="6" height="9" left="475" textpieces="4" top="765" width="359">L DISCOUNT, and L SHIPDATE columns, while the ORDERS table is</text>
2 <text font="3" height="12" left="475" textpieces="1" top="779" width="360">projected to the O ORDERKEY, O ORDERDATE, O SHIPPRIORITY, and</text>
2 <text font="6" height="9" left="475" textpieces="1" top="796" width="359">O CUSTKEYcolumns. To simulate the benet of a columnar storage</text>
2 <text font="3" height="12" left="475" textpieces="0" top="810" width="359">manager, for both tables, these four column projections (20B) were</text>
2 <text font="3" height="12" left="475" textpieces="0" top="826" width="359">stored as tuples in memory for the scan operator to read. We apply a</text>
2 <text font="3" height="12" left="475" textpieces="0" top="841" width="359">5% selectivity predicate on both the tables using a predicate on the</text>
2 <text font="6" height="9" left="475" textpieces="4" top="859" width="359">O CUSTKEYattribute forORDERS and a predicate on the L SHIPDATE</text>
2 <text font="3" height="12" left="475" textpieces="1" top="873" width="282">attribute forLINEITEM, as is done in TPC-H Query 3.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="889" width="346">To perform the partition-incompatible join in this TPC-H query</text>
2 <text font="3" height="12" left="475" textpieces="0" top="904" width="359">(Query 3), the hash join operator needs to build a hash table on the</text>
2 <text font="6" height="9" left="475" textpieces="3" top="922" width="359">ORDERS table and then probe using the LINEITEM table. There are</text>
2 <text font="3" height="12" left="475" textpieces="1" top="936" width="360">two ways to do this: (i) repartition both tables on theORDERKEY</text>
2 <text font="3" height="12" left="475" textpieces="1" top="951" width="359">attribute  a dual shufe, and (ii) broadcast the qualifyingORDERS</text>
2 <text font="3" height="12" left="475" textpieces="0" top="967" width="359">tuples to all nodes. With these two join methods, we show the effects</text>
2 <text font="3" height="12" left="475" textpieces="0" top="983" width="359">of network and disk bottlenecks as well as algorithmic bottlenecks</text>
2 <text font="3" height="12" left="475" textpieces="0" top="998" width="152">that affect energy efciency.</text>
2 <text font="9" height="14" left="479" textpieces="1" top="1030" width="131">4.3.1  Dual Shufe</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1051" width="345">By doing a repartitioning of both tables, our P-store results shows</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">behavior that is similar to that of Vertica running TPC-H Query 12</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="8" height="11" left="318" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="252" textpieces="1" top="136" width="-72">4N                               6N </text>
2 <text font="4" height="10" left="124" textpieces="0" top="84" width="17">8N </text>
2 <text font="4" height="10" left="104" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="104" textpieces="0" top="242" width="15">0.1</text>
2 <text font="4" height="10" left="104" textpieces="0" top="226" width="15">0.2</text>
2 <text font="4" height="10" left="104" textpieces="0" top="209" width="15">0.3</text>
2 <text font="4" height="10" left="104" textpieces="0" top="193" width="15">0.4</text>
2 <text font="4" height="10" left="104" textpieces="0" top="176" width="15">0.5</text>
2 <text font="4" height="10" left="104" textpieces="0" top="160" width="15">0.6</text>
2 <text font="4" height="10" left="104" textpieces="0" top="144" width="15">0.7</text>
2 <text font="4" height="10" left="104" textpieces="0" top="127" width="15">0.8</text>
2 <text font="4" height="10" left="104" textpieces="0" top="111" width="15">0.9</text>
2 <text font="4" height="10" left="104" textpieces="0" top="94" width="15">1.0</text>
2 <text font="4" height="10" left="290" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="94" textpieces="0" top="252" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="134" textpieces="0" top="283" width="150">Normalized Performance </text>
2 <text font="8" height="11" left="573" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="495" textpieces="0" top="143" width="17">4N </text>
2 <text font="4" height="10" left="420" textpieces="0" top="125" width="17">6N </text>
2 <text font="4" height="10" left="378" textpieces="0" top="84" width="17">8N </text>
2 <text font="4" height="10" left="358" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="358" textpieces="0" top="242" width="15">0.1</text>
2 <text font="4" height="10" left="358" textpieces="0" top="226" width="15">0.2</text>
2 <text font="4" height="10" left="358" textpieces="0" top="210" width="15">0.3</text>
2 <text font="4" height="10" left="358" textpieces="0" top="194" width="15">0.4</text>
2 <text font="4" height="10" left="358" textpieces="0" top="177" width="15">0.5</text>
2 <text font="4" height="10" left="358" textpieces="0" top="161" width="15">0.6</text>
2 <text font="4" height="10" left="358" textpieces="0" top="145" width="15">0.7</text>
2 <text font="4" height="10" left="358" textpieces="0" top="129" width="15">0.8</text>
2 <text font="4" height="10" left="358" textpieces="0" top="112" width="15">0.9</text>
2 <text font="4" height="10" left="358" textpieces="0" top="96" width="15">1.0</text>
2 <text font="4" height="10" left="544" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="348" textpieces="0" top="253" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="389" textpieces="0" top="283" width="150">Normalized Performance </text>
2 <text font="8" height="11" left="827" textpieces="0" top="289" width="3"> </text>
2 <text font="4" height="10" left="753" textpieces="0" top="141" width="17">4N </text>
2 <text font="4" height="10" left="675" textpieces="0" top="134" width="17">6N </text>
2 <text font="4" height="10" left="632" textpieces="0" top="86" width="17">8N </text>
2 <text font="4" height="10" left="613" textpieces="0" top="259" width="15">0.0</text>
2 <text font="4" height="10" left="613" textpieces="0" top="243" width="15">0.1</text>
2 <text font="4" height="10" left="613" textpieces="0" top="227" width="15">0.2</text>
2 <text font="4" height="10" left="613" textpieces="0" top="211" width="15">0.3</text>
2 <text font="4" height="10" left="613" textpieces="0" top="195" width="15">0.4</text>
2 <text font="4" height="10" left="613" textpieces="0" top="179" width="15">0.5</text>
2 <text font="4" height="10" left="613" textpieces="0" top="163" width="15">0.6</text>
2 <text font="4" height="10" left="613" textpieces="0" top="147" width="15">0.7</text>
2 <text font="4" height="10" left="613" textpieces="0" top="131" width="15">0.8</text>
2 <text font="4" height="10" left="613" textpieces="0" top="115" width="15">0.9</text>
2 <text font="4" height="10" left="613" textpieces="0" top="99" width="15">1.0</text>
2 <text font="4" height="10" left="799" textpieces="2" top="272" width="-149">0.50                              0.75                              1.00</text>
2 <text font="2" height="14" left="602" textpieces="0" top="255" width="0">Normalized Energy Consumption </text>
2 <text font="7" height="12" left="643" textpieces="0" top="283" width="150">Normalized Performance </text>
2 <text font="3" height="12" left="154" textpieces="2" top="300" width="642">(a) One query                            (b) Two concurrent queries                     (c) Four concurrent queries</text>
2 <text font="3" height="12" left="81" textpieces="4" top="318" width="753">Figure 4: A partition incompatible TPC-H Q3 broadcast hash join betweenLINEITEMandORDERS(scale 1000) in P-store. Each</text>
2 <text font="3" height="12" left="81" textpieces="0" top="334" width="753">subgure (a-c) shows the energy consumption and performance ratios relative to the 8 node cluster reference point. The dotted line</text>
2 <text font="3" height="12" left="81" textpieces="0" top="349" width="309">indicates the points where the EDP metric is constant.</text>
2 <text font="3" height="12" left="80" textpieces="2" top="381" width="360">(Figure 1(a)). Using P-store, rst theORDERStable is repartitioned</text>
2 <text font="3" height="12" left="81" textpieces="0" top="396" width="361">and the hash table is built on this table on-the-y (no disk material-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="412" width="359">ization) as tuples arrive over the network. After all the nodes have</text>
2 <text font="3" height="12" left="81" textpieces="2" top="428" width="358">built their hash tables, theLINEITEMtable is repartitioned and its</text>
2 <text font="3" height="12" left="81" textpieces="0" top="443" width="208">tuples probe the hash tables on-the-y.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="459" width="346">In Figures 3(a)(c), we see that poor performance scalability</text>
2 <text font="3" height="12" left="81" textpieces="0" top="475" width="359">due to network bottlenecks can allow us to save energy by using</text>
2 <text font="3" height="12" left="81" textpieces="0" top="491" width="359">fewer nodes. These gures show the comparison of relative energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="506" width="359">consumption to relative performance of the hash join with 1, 2, and</text>
2 <text font="3" height="12" left="80" textpieces="0" top="522" width="359">4 independent concurrent joins being performed respectively on 4 to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="538" width="359">8 node clusters. We increased the degree of concurrency to see how</text>
2 <text font="3" height="12" left="81" textpieces="0" top="553" width="359">multiple simultaneous requests for the network resource affected</text>
2 <text font="3" height="12" left="81" textpieces="0" top="569" width="126">the network bottleneck.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="585" width="346">Our results show that 4 nodes (4N) always consumes less energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="600" width="359">than 8 (8N). Also, as the concurrency level increases, the degree</text>
2 <text font="3" height="12" left="81" textpieces="0" top="616" width="359">of energy savings also increases (i.e., the results move closer to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="632" width="359">the dashed EDP line). In Figure 3(a), halving the cluster size only</text>
2 <text font="3" height="12" left="81" textpieces="0" top="647" width="359">results in a 38% decrease in performance and translates to almost</text>
2 <text font="3" height="12" left="81" textpieces="0" top="663" width="359">20% savings in energy consumption. At a concurrency level of</text>
2 <text font="3" height="12" left="81" textpieces="0" top="679" width="359">two (Figure 3 (b)), the 4-node cluster has a 23% increase in energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="695" width="361">savings over the 8-node cluster with a 35% penalty in performance.</text>
2 <text font="3" height="12" left="80" textpieces="0" top="710" width="361">With 4 concurrent hash joins running on the cluster (Figure 3 (c)),</text>
2 <text font="3" height="12" left="81" textpieces="0" top="726" width="359">the 4-node cluster saves 24% of the energy consumed by the 8-node</text>
2 <text font="3" height="12" left="81" textpieces="0" top="742" width="222">cluster while losing 33% in performance.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="757" width="345">The reason we see greater energy savings with more concurrent</text>
2 <text font="3" height="12" left="81" textpieces="0" top="773" width="361">queries is because the CPU utilization does not proportionally in-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="789" width="359">crease with the increasing concurrency level. This behavior is due</text>
2 <text font="3" height="12" left="81" textpieces="0" top="804" width="359">to the network being the bottleneck, and so the CPU stalls and idles</text>
2 <text font="3" height="12" left="81" textpieces="0" top="820" width="286">as other hash joins also require the network resource.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="836" width="345">To summarize, these results show that reducing the cluster size</text>
2 <text font="3" height="12" left="81" textpieces="0" top="851" width="359">can save energy, but we pay for it with a proportionally greater loss</text>
2 <text font="3" height="12" left="81" textpieces="0" top="867" width="359">in performance  i.e., these data points lie above the dashed EDP</text>
2 <text font="3" height="12" left="81" textpieces="0" top="883" width="359">line. As we have mentioned previously, ideally we would prefer</text>
2 <text font="3" height="12" left="81" textpieces="0" top="899" width="359">results that lie on or below this dotted curve. The next section shows</text>
2 <text font="3" height="12" left="81" textpieces="0" top="914" width="330">that for broadcast joins, the trade-off is much more attractive.</text>
2 <text font="9" height="14" left="85" textpieces="1" top="951" width="116">4.3.2  Broadcast</text>
2 <text font="3" height="12" left="94" textpieces="2" top="973" width="345">The broadcast join method scans and lters theORDERStable, and</text>
2 <text font="3" height="12" left="81" textpieces="0" top="988" width="360">then sends the qualifying tuples to all the other nodes. Therefore,</text>
2 <text font="3" height="12" left="81" textpieces="3" top="1004" width="358">the fullORDERShash table is built by each node and theLINEITEM</text>
2 <text font="3" height="12" left="81" textpieces="1" top="1020" width="358">table does not need to be repartitioned. To keep the fullORDERS</text>
2 <text font="3" height="12" left="81" textpieces="2" top="1035" width="359">hash table in memory, we increased theORDERStable selectivity</text>
2 <text font="3" height="12" left="81" textpieces="2" top="1051" width="327">from 5% to 1% but held theLINEITEMtable selectivity at 5%.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="1067" width="348">The results for this experiment are shown in Figure 4(a)(c).</text>
=============================== COL ===================================
2 <text font="8" height="12" left="825" textpieces="0" top="558" width="3"> </text>
2 <text font="6" height="10" left="721" textpieces="0" top="424" width="52">Half Cluster </text>
2 <text font="6" height="10" left="615" textpieces="0" top="418" width="20">75% </text>
2 <text font="6" height="10" left="646" textpieces="0" top="448" width="52">Half Cluster </text>
2 <text font="6" height="10" left="581" textpieces="0" top="432" width="20">75% </text>
2 <text font="6" height="10" left="769" textpieces="0" top="411" width="52">Half Cluster </text>
2 <text font="6" height="10" left="648" textpieces="0" top="385" width="20">75% </text>
2 <text font="6" height="10" left="539" textpieces="0" top="393" width="50">Full Cluster </text>
2 <text font="6" height="10" left="518" textpieces="0" top="526" width="5">0</text>
2 <text font="6" height="10" left="510" textpieces="0" top="501" width="13">0.2</text>
2 <text font="6" height="10" left="510" textpieces="0" top="476" width="13">0.4</text>
2 <text font="6" height="10" left="510" textpieces="0" top="451" width="13">0.6</text>
2 <text font="6" height="10" left="510" textpieces="0" top="426" width="13">0.8</text>
2 <text font="6" height="10" left="518" textpieces="0" top="401" width="5">1</text>
2 <text font="6" height="10" left="510" textpieces="0" top="376" width="13">1.2</text>
2 <text font="6" height="10" left="804" textpieces="6" top="539" width="-269">0.4              0.5              0.6               0.7              0.8              0.9              1</text>
2 <text font="7" height="13" left="607" textpieces="0" top="552" width="131">Normalized Performance </text>
2 <text font="7" height="13" left="677" textpieces="0" top="485" width="96">shuffle both tables</text>
2 <text font="7" height="13" left="677" textpieces="0" top="499" width="109">broadcast small table</text>
2 <text font="7" height="13" left="677" textpieces="0" top="513" width="144">prepartitioned (no network)</text>
2 <text font="7" height="13" left="500" textpieces="0" top="542" width="0">Normalized Energy Consumption </text>
2 <text font="10" height="12" left="544" textpieces="0" top="471" width="219">Energy savings of half cluster over full cluster </text>
2 <text font="8" height="12" left="544" textpieces="0" top="485" width="94">18% energy savings </text>
2 <text font="8" height="12" left="544" textpieces="0" top="499" width="94">26% energy savings </text>
2 <text font="8" height="12" left="544" textpieces="0" top="513" width="90">Mostly unchanged </text>
2 <text font="3" height="12" left="475" textpieces="0" top="575" width="361">Figure 5: Network and algorithmic bottlenecks cause non-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="590" width="359">linear scalability in the partition-incompatible joins which</text>
2 <text font="3" height="12" left="475" textpieces="0" top="606" width="359">mean smaller cluster designs consume less energy than larger</text>
2 <text font="3" height="12" left="475" textpieces="0" top="622" width="361">designs. If the query is perfectly partitioned with ideal scalabil-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="637" width="359">ity (Vertica TPC-H Q1, Figure 2(a)), changing the number of</text>
2 <text font="3" height="12" left="475" textpieces="0" top="653" width="348">nodes only affects performance and not energy consumption.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="687" width="359">From these gures, we observe that the data points now lie on the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="703" width="359">EDP line, indicating that we proportionally trade an X% decrease in</text>
2 <text font="3" height="12" left="475" textpieces="0" top="719" width="359">performance for an X% decrease in energy consumption compared</text>
2 <text font="3" height="12" left="475" textpieces="0" top="734" width="359">to the 8 node case (8N). Similar to the dual shufe cases, here we</text>
2 <text font="3" height="12" left="475" textpieces="0" top="750" width="269">also used various concurrency levels  1, 2, and 4.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="766" width="347">In Figure 4(a), with one join running, the performance only de-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="782" width="361">creases by 32% when we halve the cluster size from 8 to 4 nodes.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="797" width="359">With 2 and 4 concurrent joins, the performance decreases by around</text>
2 <text font="3" height="12" left="475" textpieces="0" top="813" width="359">30% in Figures 4(b,c) when halving the cluster size. This drop in</text>
2 <text font="3" height="12" left="475" textpieces="0" top="829" width="360">performance causes the 4 node cluster to always save between 25%</text>
2 <text font="3" height="12" left="475" textpieces="0" top="844" width="358">to 30% in energy consumption compared to the full 8 node cluster.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="860" width="345">Compared to the dual shufe join (see Figure 3), the broadcast</text>
2 <text font="3" height="12" left="475" textpieces="0" top="876" width="359">join saves more energy when using 4 nodes rather than 8 nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="891" width="359">(data points lie closer to the EDP line in Figure 4). This means that</text>
2 <text font="3" height="12" left="475" textpieces="0" top="907" width="359">the broadcast join suffers a higher degree of non-linear scalability</text>
2 <text font="3" height="12" left="475" textpieces="1" top="923" width="359">than the dual shufe join. This is because broadcasting theORDERS</text>
2 <text font="3" height="12" left="475" textpieces="0" top="938" width="359">table does not get faster with 8 nodes since every node must receive</text>
2 <text font="3" height="12" left="475" textpieces="0" top="954" width="349">roughly the entire table (7/8) over the network (see Section 4.1).</text>
2 <text font="1" height="16" left="475" textpieces="1" top="981" width="122">4.4  Discussion</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1004" width="345">Figure 5 summarizes our ndings. The energy consumption of the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1020" width="359">system, when running a 2-way join under different query execution</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="361">plans, can vary signicantly under different cluster congurations.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1051" width="361">Due to sub-linear performance speedup, when the join is not parti-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="360">tion compatible (shufe both tables and broadcast small table),</text>
=============================== PAGE ===================================
=============================== COL ===================================
1 <text font="8" height="11" left="94" textpieces="3" top="82" width="332">System          CPU (cores/threads)   RAM    Idle Power (W)</text>
1 <text font="8" height="11" left="94" textpieces="3" top="97" width="332">Workstation A              i7 920 (4/8)   12GB                93W</text>
1 <text font="8" height="11" left="94" textpieces="3" top="110" width="332">Workstation B               Xeon (4/4)   24GB                69W</text>
1 <text font="8" height="11" left="94" textpieces="3" top="124" width="332">Desktop                     Atom (2/4)     4GB                28W</text>
1 <text font="8" height="11" left="94" textpieces="3" top="137" width="331">Laptop A              Core 2 Duo (2/2)    4GB   12W (screen off)</text>
1 <text font="8" height="11" left="94" textpieces="3" top="150" width="331">Laptop B                 i7 620m (2/4)    8GB   11W (screen off)</text>
2 <text font="3" height="12" left="104" textpieces="0" top="180" width="308">Table 2: Hardware conguration of different systems.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="205" width="360">halving the cluster size does not result in doubling the response time,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="220" width="361">and this is one reason why the energy consumption at the Half Clus-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="236" width="360">ter conguration is lower than at Full Cluster point. Furthermore,</text>
2 <text font="3" height="12" left="80" textpieces="0" top="252" width="359">we can see that when we use half of the cluster nodes instead of the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="267" width="359">full cluster, the broadcast join method saves more energy and suffers</text>
2 <text font="3" height="12" left="81" textpieces="0" top="283" width="360">less performance penalty than the dual shufe join. This is because,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="299" width="359">for the broadcast join approach, the hash join build phase does not</text>
2 <text font="3" height="12" left="81" textpieces="0" top="314" width="359">get faster with more nodes and so 4 nodes is much more efcient</text>
2 <text font="3" height="12" left="81" textpieces="0" top="330" width="359">than 8 nodes. We can put this result in perspective by comparing</text>
2 <text font="3" height="12" left="81" textpieces="0" top="346" width="359">these results to the partitioned TPC-H Q1 result from Vertica, where</text>
2 <text font="3" height="12" left="81" textpieces="0" top="362" width="321">the energy consumption is at regardless of the cluster size.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="394" width="220">5.  ON CLUSTER DESIGN</text>
2 <text font="3" height="12" left="94" textpieces="0" top="417" width="347">Our empirical results using two off-the-shelf DBMSs and a cus-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="433" width="359">tom parallel query execution kernel have shown that a number of key</text>
2 <text font="3" height="12" left="81" textpieces="0" top="448" width="359">bottlenecks cause sub-linear speedup. These diminishing returns</text>
2 <text font="3" height="12" left="81" textpieces="0" top="464" width="359">in performance, when additional cluster nodes are added, are a key</text>
2 <text font="3" height="12" left="81" textpieces="0" top="480" width="361">reason why the energy consumption typically drops when we re-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="496" width="359">duce the cluster size. Observing this reoccurring pattern of smaller</text>
2 <text font="3" height="12" left="81" textpieces="0" top="511" width="359">clusters can save energy suggests that the presence of performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="527" width="257">bottlenecks is a key factor for energy efciency.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="543" width="345">However, we have thus far ignored the other factor for total system</text>
2 <text font="3" height="12" left="81" textpieces="0" top="558" width="359">energy consumption: namely, the power characteristics of a single</text>
2 <text font="3" height="12" left="81" textpieces="0" top="574" width="359">node. As we demonstrate in this section, the hardware conguration</text>
2 <text font="3" height="12" left="80" textpieces="0" top="590" width="359">(and performance capability) of each individual node also plays</text>
2 <text font="3" height="12" left="81" textpieces="0" top="605" width="359">a signicant role in improving the energy efciency of parallel</text>
2 <text font="3" height="12" left="81" textpieces="0" top="621" width="359">DBMSs, and needs to be considered for energy-efcient cluster</text>
2 <text font="3" height="12" left="81" textpieces="0" top="637" width="360">design. By comparing some representative hardware congurations,</text>
2 <text font="3" height="12" left="80" textpieces="0" top="652" width="359">we found one of our Wimpy laptop congurations yielded the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="668" width="360">lowest energy consumption in single node experiments. As such,</text>
2 <text font="3" height="12" left="80" textpieces="0" top="684" width="359">we ask the question: Given what we now know about performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="700" width="361">bottlenecks and energy efciency, what if we introduced these so-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="715" width="301">called Wimpy nodes into a parallel database cluster?</text>
2 <text font="3" height="12" left="94" textpieces="0" top="731" width="347">In the remainder of this paper, we explore how query parameters,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="747" width="359">performance bottlenecks, and cluster design are the key factors that</text>
2 <text font="3" height="12" left="80" textpieces="0" top="762" width="361">we should consider if we were to construct an energy-efcient clus-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="778" width="359">ter from scratch. We rst show that Wimpy nodes consume less</text>
2 <text font="3" height="12" left="81" textpieces="0" top="794" width="359">energy per query than Beefy nodes (Section 5.1). Then, using</text>
2 <text font="3" height="12" left="81" textpieces="0" top="809" width="359">P-store we ran parallel hash joins on heterogeneous cluster designs</text>
2 <text font="3" height="12" left="80" textpieces="0" top="825" width="361">(Section 5.2), and used these results to generate and validate a perfor-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="841" width="359">mance/energy consumption model (Sections 5.3). Finally, using this</text>
2 <text font="3" height="12" left="81" textpieces="0" top="856" width="359">model, we explore the effects of some important query and cluster</text>
2 <text font="3" height="12" left="81" textpieces="0" top="872" width="359">parameters (Section 5.4) to produce insights about the characteristics</text>
2 <text font="3" height="12" left="81" textpieces="0" top="888" width="306">of the energy-efcient cluster design space (Section 5.5).</text>
2 <text font="1" height="16" left="81" textpieces="1" top="912" width="331">5.1  Energy Efciency of Individual Nodes</text>
2 <text font="3" height="12" left="94" textpieces="0" top="935" width="345">In this section we demonstrate that non-server, low-power nodes</text>
2 <text font="3" height="12" left="81" textpieces="0" top="951" width="359">consume signicantly lower amounts of energy to perform the same</text>
2 <text font="3" height="12" left="81" textpieces="0" top="966" width="359">task as a traditional Beefy server nodes. For the rest of the results</text>
2 <text font="3" height="12" left="81" textpieces="0" top="982" width="359">in this paper, we had physical access to the nodes/servers so we</text>
2 <text font="3" height="12" left="81" textpieces="0" top="998" width="361">measured power directly from the outlet using a WattsUp Pro meter.</text>
2 <text font="3" height="12" left="80" textpieces="0" top="1013" width="359">The meter provided a 1Hz sampling frequency with a measurement</text>
2 <text font="3" height="12" left="81" textpieces="1" top="1029" width="124">accuracy of +/- 1.5%.5</text>
2 <text font="5" height="8" left="82" textpieces="0" top="1051" width="356">5We observed that the server CPU utilization/power models from these</text>
2 <text font="8" height="11" left="81" textpieces="0" top="1068" width="288">measurements validate our iLO2-based approach in Table 1.</text>
=============================== COL ===================================
2 <text font="4" height="10" left="825" textpieces="0" top="246" width="2"> </text>
2 <text font="5" height="9" left="726" textpieces="0" top="109" width="31">Desktop </text>
2 <text font="5" height="9" left="778" textpieces="0" top="131" width="34">Laptop A </text>
2 <text font="5" height="9" left="637" textpieces="0" top="148" width="33">Laptop B </text>
2 <text font="5" height="9" left="549" textpieces="0" top="142" width="53">Workstation A </text>
2 <text font="5" height="9" left="572" textpieces="0" top="93" width="53">Workstation B </text>
2 <text font="6" height="11" left="517" textpieces="0" top="215" width="5">0</text>
2 <text font="6" height="11" left="507" textpieces="0" top="194" width="16">300</text>
2 <text font="6" height="11" left="507" textpieces="0" top="172" width="16">600</text>
2 <text font="6" height="11" left="507" textpieces="0" top="151" width="16">900</text>
2 <text font="6" height="11" left="501" textpieces="0" top="130" width="21">1200</text>
2 <text font="6" height="11" left="501" textpieces="0" top="109" width="21">1500</text>
2 <text font="6" height="11" left="501" textpieces="0" top="88" width="21">1800</text>
2 <text font="6" height="11" left="530" textpieces="5" top="229" width="289">0            10           20           30           40           50</text>
2 <text font="6" height="11" left="496" textpieces="0" top="190" width="0">Energy Consumed (J) </text>
2 <text font="6" height="11" left="644" textpieces="0" top="241" width="80">Response Time (s) </text>
2 <text font="4" height="10" left="685" textpieces="0" top="149" width="102">Lowest amount of energy </text>
2 <text font="4" height="10" left="685" textpieces="0" top="163" width="98">to perform the hash join </text>
2 <text font="3" height="12" left="489" textpieces="0" top="254" width="326">Figure 6: A hashjoin: 0.1M and 20M tuple (100B) tables.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="292" width="345">We studied ve systems with different power and performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="307" width="359">characteristics, ranging from low-power, ultra-mobile laptops to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="323" width="361">high-end workstations. Laptops are optimized for power consump-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="339" width="361">tion and are typically equipped with mobile CPUs and SSDs, whereas</text>
2 <text font="3" height="12" left="475" textpieces="0" top="354" width="361">high-end workstations are optimized for performance. The congu-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="370" width="320">ration and power consumption details are shown in Table 2.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="386" width="347">To assess the energy efciency of these systems, we used an in-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="401" width="359">memory database workload. This workload executes a basic hash</text>
2 <text font="3" height="12" left="475" textpieces="0" top="417" width="359">join operation, and is designed to stress modern CPUs (the hash</text>
2 <text font="3" height="12" left="475" textpieces="0" top="433" width="359">join code is cache-conscious and multi-threaded). Our hash join is</text>
2 <text font="3" height="12" left="475" textpieces="0" top="449" width="359">between a 10MB table (100K cardinality, and 100 byte tuples) and</text>
2 <text font="3" height="12" left="475" textpieces="0" top="464" width="277">a 2GB table (20M cardinality, and 100 byte tuples).</text>
2 <text font="3" height="12" left="489" textpieces="0" top="480" width="345">Figure 6 plots the energy consumed versus the hash join response</text>
2 <text font="3" height="12" left="475" textpieces="0" top="496" width="359">time for the different congurations. From this gure, we observe</text>
2 <text font="3" height="12" left="475" textpieces="0" top="511" width="359">that the Laptop B system consumes the lowest energy for processing</text>
2 <text font="3" height="12" left="475" textpieces="0" top="527" width="359">this in-memory hash join. As expected, the high-end workstations</text>
2 <text font="3" height="12" left="475" textpieces="0" top="543" width="360">exhibit the best performance (lowest response time). However,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="558" width="359">the workstations are not the best when we consider the energy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="574" width="359">consumption. The energy consumption of Laptop B is 800 Joules</text>
2 <text font="3" height="12" left="475" textpieces="0" top="590" width="361">while the energy consumption of Workstation A is near 1300 Joules,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="605" width="359">even though it takes signicantly longer to perform the in-memory</text>
2 <text font="3" height="12" left="475" textpieces="0" top="621" width="359">join on the laptop. As this experiment suggests, low-power systems</text>
2 <text font="3" height="12" left="475" textpieces="0" top="637" width="359">can reduce the average power that they draw more than they reduce</text>
2 <text font="3" height="12" left="475" textpieces="0" top="653" width="359">performance, thereby reducing the energy consumption of running</text>
2 <text font="3" height="12" left="475" textpieces="0" top="668" width="360">a database query. Since Laptop B consumed the least energy,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="684" width="359">we use it to represent a Wimpy server node when considering</text>
2 <text font="3" height="12" left="475" textpieces="0" top="700" width="254">architectural designs of heterogeneous clusters.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="715" width="347">Combining these results with the scalability and bottleneck obser-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="731" width="359">vations (from Section 4.2), next we explore energy-efcient cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="747" width="361">design points, starting with experimental evidence of potential de-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="762" width="100">sign opportunities.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="793" width="279">5.2  Heterogeneous Clusters Design</text>
2 <text font="3" height="12" left="489" textpieces="0" top="816" width="345">We prototyped two different four node clusters and measured the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="831" width="359">energy efciency for dual shufe hash joins (see Section 4.3), using</text>
2 <text font="3" height="12" left="475" textpieces="0" top="847" width="359">P-store. Each cluster node has a 1Gbs network card and is connected</text>
2 <text font="3" height="12" left="475" textpieces="0" top="863" width="359">through a 10/100/1000 SMCGS5 switch. Node power was measured</text>
2 <text font="3" height="12" left="475" textpieces="0" top="879" width="359">using the WattsUp power meters as described in Section 5.1. The</text>
2 <text font="3" height="12" left="475" textpieces="0" top="894" width="194">cluster specications are as follows.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="910" width="345">Beefy Cluster: This cluster has four HP ProLiant SE326M1R2</text>
2 <text font="3" height="12" left="475" textpieces="0" top="926" width="359">servers with dual low-power quad-core Nehalem-class Xeon L5630</text>
2 <text font="3" height="12" left="475" textpieces="0" top="941" width="359">processors. Each node also has 32GB of memory and dual Crucial</text>
2 <text font="3" height="12" left="475" textpieces="0" top="957" width="359">C300 256GB SSDs (only one was used for data storage). During</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="283">our experiments, the average node power was 154W.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="988" width="345">2 Beefy/2 Wimpy: This cluster has two beefy nodes from the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1004" width="359">Beefy cluster above, and two Laptop Bs (from Section 5.1), with</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1020" width="361">i7 620m CPUs, 8GB of memory, and a Crucial C300 256GB SSD.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="326">During our experiments, the average laptop power was 37W.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1051" width="345">Before we continue with the experimental results, there are two</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="361">important notes to make. First, P-store does not support out-of-</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="3" height="12" left="81" textpieces="0" top="87" width="359">memory joins (2-pass joins), and therefore we either run in-memory</text>
2 <text font="3" height="12" left="81" textpieces="0" top="102" width="359">joins across all the nodes (homogeneous execution), or we only</text>
2 <text font="3" height="12" left="81" textpieces="0" top="118" width="359">perform the join on the nodes that have enough memory while the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="134" width="361">other nodes simply scan and lter data (heterogeneous execution).</text>
2 <text font="3" height="12" left="81" textpieces="0" top="149" width="359">Since energy is a function of time and average power, in-memory</text>
2 <text font="3" height="12" left="81" textpieces="0" top="165" width="359">join processing dramatically reduces the response time (as well as</text>
2 <text font="3" height="12" left="81" textpieces="0" top="181" width="359">maintains high CPU utilization) and hence provides a substantial</text>
2 <text font="3" height="12" left="81" textpieces="0" top="196" width="359">decrease in energy consumption per query. Second, our network has</text>
2 <text font="3" height="12" left="81" textpieces="0" top="212" width="359">a peak capacity of 1Gbps, and therefore is typically the bottleneck</text>
2 <text font="3" height="12" left="81" textpieces="0" top="228" width="359">for non-selective (where a high percentage of input tuples satisfy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="243" width="359">the selection predicates) queries. While a faster network could be</text>
2 <text font="3" height="12" left="81" textpieces="0" top="259" width="359">used, as we discussed in Section 4.1, the network-CPU performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="275" width="227">gap is likely to persist into the near future.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="291" width="345">Using P-store, we ran the same hash join necessary for TPC-H</text>
2 <text font="3" height="12" left="81" textpieces="4" top="306" width="358">Q3 between theLINEITEMand theORDERStables (as was done in</text>
2 <text font="3" height="12" left="81" textpieces="0" top="322" width="359">the experiment described in Section 4.3), but with a scale factor</text>
2 <text font="3" height="12" left="81" textpieces="2" top="338" width="359">of 400. The working sets (after projection) for theLINEITEMand</text>
2 <text font="3" height="12" left="81" textpieces="2" top="353" width="358">theORDERStables are 48GB and 12GB respectively. We warmed</text>
2 <text font="3" height="12" left="81" textpieces="0" top="369" width="361">our memory cache with as much of the working set as possible.</text>
2 <text font="3" height="12" left="80" textpieces="0" top="385" width="359">The hash join is partition-incompatible on both the tables just as in</text>
2 <text font="3" height="12" left="81" textpieces="0" top="400" width="359">Section 4.3 (i.e., dual shufe is needed). We varied the selectivity</text>
2 <text font="3" height="12" left="81" textpieces="3" top="416" width="358">on theLINEITEMtable to 1%, 10%, 50%, and 100%. TheORDERS</text>
2 <text font="3" height="12" left="81" textpieces="0" top="432" width="359">table had a selectivity of 1% and 10%. This gave us 8 different hash</text>
2 <text font="3" height="12" left="81" textpieces="0" top="447" width="84">join workloads.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="463" width="345">The Beefy cluster can run all of the 8 hash join workloads by rst</text>
2 <text font="3" height="12" left="81" textpieces="3" top="479" width="358">repartitioningORDERSon the join keyO ORDERKEY, and building</text>
2 <text font="3" height="12" left="81" textpieces="0" top="494" width="359">the hash table on each node as tuples arrive over the network. The</text>
2 <text font="6" height="9" left="81" textpieces="3" top="512" width="360">LINEITEM table is then repartitioned on the L ORDERKEY attribute,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="526" width="359">and each node probes their hash table on-the-y as tuples arrive</text>
2 <text font="3" height="12" left="81" textpieces="0" top="542" width="359">over the network. The beefy nodes have enough memory to cache</text>
2 <text font="3" height="12" left="81" textpieces="1" top="557" width="358">the working set and build the in-memory hash table for theORDERS</text>
2 <text font="3" height="12" left="81" textpieces="2" top="573" width="308">table for both the 1% and 10%ORDERSselectivity values.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="589" width="346">The hash join parameters cause the need for the 2 Beefy/2 Wimpy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="604" width="361">cluster to alternate between homogeneous and heterogeneous execu-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="620" width="359">tion. The wimpy nodes only have 8GB of memory, and hence can</text>
2 <text font="3" height="12" left="81" textpieces="2" top="636" width="359">only cache the 3GBORDERStable partition and some of the 12GB</text>
2 <text font="6" height="9" left="81" textpieces="1" top="653" width="358">LINEITEMtable partition. Thus, for the 2 Beefy/2 Wimpy cluster, a</text>
2 <text font="3" height="12" left="80" textpieces="2" top="667" width="359">1% selectivity onORDERSallows the hash table to t in the laptop</text>
2 <text font="3" height="12" left="81" textpieces="0" top="683" width="359">memory, and we can execute the join in the same way as the Beefy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="698" width="359">cluster  homogeneous execution. However, if the selectivity on</text>
2 <text font="6" height="9" left="81" textpieces="1" top="716" width="361">ORDERS is low (i.e., the predicate matches  10% of the input tu-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="730" width="359">ples), then we can only leverage the wimpy nodes to scan and lter</text>
2 <text font="3" height="12" left="81" textpieces="0" top="746" width="359">their partitions, and have them send all the qualifying data to the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="761" width="359">beefy nodes where the actual hash tables are built  heterogeneous</text>
2 <text font="3" height="12" left="81" textpieces="1" top="777" width="358">execution. Similarly, the wimpy nodes scan and lter theLINEITEM</text>
2 <text font="3" height="12" left="80" textpieces="0" top="793" width="308">(probe) tuples and repartition the data to the beefy nodes.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="808" width="345">Therefore, in our study, we consider two wimpy aspects of our</text>
2 <text font="3" height="12" left="81" textpieces="0" top="824" width="361">mobile nodes: (1) their lower power and performance due to low-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="840" width="359">end CPUs, and (2) their lower memory capacity which constrains</text>
2 <text font="3" height="12" left="81" textpieces="0" top="856" width="252">the execution strategies for evaluating a query.</text>
2 <text font="9" height="14" left="85" textpieces="1" top="889" width="352">5.2.1  Small Hash Tables  Homogeneous Execution</text>
2 <text font="3" height="12" left="94" textpieces="0" top="910" width="346">Homogeneous parallel execution of a hash join requires a highly</text>
2 <text font="3" height="12" left="81" textpieces="2" top="926" width="358">selective predicate that produces a smallORDERShash table that can</text>
2 <text font="3" height="12" left="81" textpieces="0" top="941" width="359">be stored in memory on all the nodes. We measured the response</text>
2 <text font="3" height="12" left="81" textpieces="0" top="957" width="359">time (seconds) and the energy consumed (Joules) of both our cluster</text>
2 <text font="3" height="12" left="81" textpieces="0" top="973" width="361">designs when running the hash join where the selectivity of the predi-</text>
2 <text font="3" height="12" left="81" textpieces="2" top="988" width="358">cate on theORDERStable was 1%. Figure 7 (a) shows the comparison</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1004" width="359">of the all Beefy (AB) cluster to the 2 Beefy/2 Wimpy (BW) cluster</text>
2 <text font="3" height="12" left="80" textpieces="2" top="1020" width="359">when we vary theLINEITEMtable selectivity (L1,L10,L50,L100) for</text>
2 <text font="3" height="12" left="81" textpieces="2" top="1035" width="360">a 1% selectivity on theORDERStable (O1). We notice that for the 1%</text>
2 <text font="3" height="12" left="81" textpieces="2" top="1051" width="359">and 10%LINEITEMselectivity cases (the circle and square markers</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1067" width="359">respectively), the AB cluster consumed less energy than the BW</text>
=============================== COL ===================================
2 <text font="6" height="11" left="834" textpieces="0" top="278" width="2"> </text>
2 <text font="4" height="10" left="755" textpieces="0" top="92" width="51">AB-O1/L100 </text>
2 <text font="4" height="10" left="646" textpieces="0" top="149" width="46">AB-O1/L50 </text>
2 <text font="4" height="10" left="536" textpieces="0" top="208" width="46">AB-O1/L10 </text>
2 <text font="4" height="10" left="541" textpieces="0" top="237" width="41">AB-O1/L1 </text>
2 <text font="4" height="10" left="779" textpieces="0" top="147" width="54">BW-O1/L100 </text>
2 <text font="4" height="10" left="659" textpieces="0" top="196" width="49">BW-O1/L50 </text>
2 <text font="4" height="10" left="622" textpieces="0" top="210" width="49">BW-O1/L10 </text>
2 <text font="4" height="10" left="587" textpieces="0" top="224" width="44">BW-O1/L1 </text>
2 <text font="8" height="12" left="506" textpieces="0" top="241" width="6">0</text>
2 <text font="8" height="12" left="499" textpieces="0" top="201" width="12">25</text>
2 <text font="8" height="12" left="499" textpieces="0" top="161" width="12">50</text>
2 <text font="8" height="12" left="499" textpieces="0" top="121" width="12">75</text>
2 <text font="8" height="12" left="493" textpieces="0" top="81" width="18">100</text>
2 <text font="8" height="12" left="520" textpieces="4" top="256" width="-32">0                50               100              150                                                                  Energy Consumed by System (kJ) </text>
2 <text font="8" height="12" left="606" textpieces="0" top="273" width="112">Join Response Time (s) </text>
2 <text font="3" height="12" left="574" textpieces="0" top="293" width="160">(a) all nodes build hash tables</text>
2 <text font="6" height="11" left="834" textpieces="0" top="513" width="2"> </text>
2 <text font="4" height="10" left="685" textpieces="0" top="332" width="56">AB-O10/L100 </text>
2 <text font="4" height="10" left="600" textpieces="0" top="404" width="51">AB-O10/L50 </text>
2 <text font="4" height="10" left="534" textpieces="0" top="436" width="51">AB-O10/L10 </text>
2 <text font="4" height="10" left="526" textpieces="0" top="468" width="44">AB-010/L1 </text>
2 <text font="4" height="10" left="762" textpieces="0" top="344" width="59">BW-O10/L100 </text>
2 <text font="4" height="10" left="663" textpieces="0" top="407" width="54">BW-O10/L50 </text>
2 <text font="4" height="10" left="568" textpieces="0" top="457" width="54">BW-O10/L10 </text>
2 <text font="4" height="10" left="610" textpieces="0" top="437" width="49">BW-O10/L1 </text>
2 <text font="8" height="12" left="506" textpieces="0" top="476" width="6">0</text>
2 <text font="8" height="12" left="499" textpieces="0" top="444" width="12">25</text>
2 <text font="8" height="12" left="499" textpieces="0" top="412" width="12">50</text>
2 <text font="8" height="12" left="499" textpieces="0" top="380" width="12">75</text>
2 <text font="8" height="12" left="493" textpieces="0" top="348" width="18">100</text>
2 <text font="8" height="12" left="493" textpieces="0" top="317" width="18">125</text>
2 <text font="8" height="12" left="520" textpieces="7" top="491" width="-32">0        50       100       150      200      250       300                                                                           Energy Consumed by System (kJ) </text>
2 <text font="8" height="12" left="606" textpieces="0" top="508" width="112">Join Response Time (s) </text>
2 <text font="3" height="12" left="485" textpieces="0" top="528" width="338">(b) beefy nodes build hash tables, wimpy nodes scan/lter data</text>
2 <text font="3" height="12" left="475" textpieces="2" top="549" width="360">Figure 7: P-store dual-shufe hash join betweenLINEITEM(L)</text>
2 <text font="3" height="12" left="475" textpieces="2" top="565" width="359">andORDERS(O) tables at various selectivities (e.g., O10 means</text>
2 <text font="3" height="12" left="474" textpieces="2" top="581" width="362">10% selectivity on theORDERStable). Empirical hash join en-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="596" width="359">ergy efciency of the all Beefy (AB) versus the 2 Beefy/2 Wimpy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="612" width="82">clusters (BW).</text>
2 <text font="3" height="12" left="475" textpieces="2" top="640" width="361">cluster. However, for the 50%LINEITEMselectivity case (triangle),</text>
2 <text font="3" height="12" left="475" textpieces="0" top="655" width="359">the BW cluster saves 43% of the energy consumed over the AB</text>
2 <text font="3" height="12" left="475" textpieces="2" top="671" width="359">cluster. When theLINEITEMtable has no predicate (diamond), the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="687" width="354">BW cluster saves 56% of the energy consumed by the AB cluster.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="702" width="345">Here we illustrate one of the bottlenecks we discussed above in</text>
2 <text font="3" height="12" left="475" textpieces="2" top="718" width="361">Section 4: namely the network/disk. With 100%LINEITEMselectiv-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="734" width="359">ity, the bottleneck is network bandwidth: the bottleneck response</text>
2 <text font="3" height="12" left="475" textpieces="0" top="750" width="359">time of the AB cluster is 155s, while the response time of the BW</text>
2 <text font="3" height="12" left="475" textpieces="2" top="765" width="359">cluster is 168s. With 1%LINEITEMselectivity, we are bound by</text>
2 <text font="3" height="12" left="475" textpieces="0" top="781" width="359">the scan/lter limits of the wimpy, mobile nodes: the AB cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="797" width="347">nishes executing this join in 8s while the BW cluster takes 50s.</text>
2 <text font="9" height="14" left="479" textpieces="1" top="826" width="355">5.2.2  Large Hash Tables  Heterogeneous Execution</text>
2 <text font="3" height="12" left="489" textpieces="0" top="847" width="345">As mentioned above, in the cases where the hash tables are larger</text>
2 <text font="3" height="12" left="475" textpieces="0" top="863" width="359">than the available memory in the wimpy, mobile nodes, the wimpy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="879" width="359">nodes of the mixed node cluster simply scan and lter the data for</text>
2 <text font="3" height="12" left="475" textpieces="0" top="894" width="359">the Beefy nodes. Figure 7 (b) shows the comparison of the AB</text>
2 <text font="3" height="12" left="475" textpieces="0" top="910" width="359">cluster to the BW cluster in terms of energy efciency, similar to</text>
2 <text font="3" height="12" left="475" textpieces="2" top="926" width="359">Figure 7 (a). Like our previous result for the 1%ORDERSselectivity</text>
2 <text font="3" height="12" left="475" textpieces="0" top="941" width="359">case, the BW cluster consumes less energy than the AB cluster</text>
2 <text font="3" height="12" left="475" textpieces="2" top="957" width="360">at a lowLINEITEMselectivity (50% and 100%). The BW cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="359">consumes 7% and 13% less energy than the AB cluster at 50% and</text>
2 <text font="3" height="12" left="474" textpieces="2" top="988" width="213">100%LINEITEMselectivity respectively.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1004" width="345">Thus, we see that in both situations, a heterogeneous cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1020" width="359">can offer improved energy efciency at reduced performance. To</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="359">further explore the full spectrum of available cluster and workload</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1051" width="359">parameters that are important for cluster design, we built a model</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">of P-stores performance and energy consumption. Our model is</text>
=============================== PAGE ===================================
=============================== COL ===================================
1 <text font="6" height="9" left="84" textpieces="3" top="84" width="277">Tbld Build phase time (s)             Tprb Probe phase time (s)</text>
1 <text font="6" height="9" left="82" textpieces="3" top="96" width="288">Ebld Build phase energy (J)           EprbProbe phase energy (J)</text>
1 <text font="6" height="9" left="87" textpieces="3" top="108" width="254">NB # Beefy nodes                    NW # Wimpy nodes</text>
1 <text font="6" height="9" left="85" textpieces="3" top="120" width="303">MB Beefy memory size (MB)        MW Wimpy memory size (MB)</text>
1 <text font="6" height="10" left="99" textpieces="1" top="132" width="292">I Disk bandwidth (MB/s)              L Network bandwidth (MB/s)</text>
1 <text font="6" height="10" left="86" textpieces="1" top="144" width="323">Bld Hash join build table size (MB)  P rb Hash join probe table size (MB)</text>
1 <text font="6" height="9" left="84" textpieces="2" top="156" width="325">Sbld Build table predicate selectivity SprbProbe table predicate selectivity</text>
1 <text font="6" height="9" left="129" textpieces="1" top="168" width="277">RW bld Rate at which a Wimpy node builds its hash table (MB/s)</text>
1 <text font="6" height="9" left="132" textpieces="1" top="180" width="268">RBbld Rate at which a Beefy node builds its hash table (MB/s)</text>
1 <text font="6" height="9" left="130" textpieces="1" top="192" width="256">UW bld Wimpy node CPU bandwidth during the build phase</text>
1 <text font="6" height="9" left="133" textpieces="1" top="204" width="247">UBbld Beefy node CPU bandwidth during the build phase</text>
1 <text font="6" height="9" left="128" textpieces="1" top="216" width="289">RW prb Rate at which the Wimpy node probes its hash table (MB/s)</text>
1 <text font="6" height="9" left="130" textpieces="1" top="228" width="281">RBprb Rate at which the Beefy node probes its hash table (MB/s)</text>
1 <text font="6" height="9" left="128" textpieces="1" top="240" width="261">UW prb Wimpy node CPU bandwidth during the probe phase</text>
1 <text font="6" height="9" left="131" textpieces="1" top="252" width="252">UBprb Beefy node CPU bandwidth during the probe phase</text>
1 <text font="6" height="9" left="107" textpieces="1" top="264" width="275">CB= 5037 Maximum CPU bandwidth of a Beefy node (MB/s)</text>
1 <text font="6" height="9" left="104" textpieces="1" top="276" width="284">CW = 1129 Maximum CPU bandwidth of a Wimpy node (MB/s)</text>
1 <text font="6" height="9" left="108" textpieces="1" top="288" width="241">GB = 0.25 Beefy CPU utilization constants for P-store</text>
1 <text font="6" height="9" left="105" textpieces="1" top="300" width="249">GW = 0.13 Wimpy CPU utilization constants for P-store</text>
1 <text font="6" height="9" left="86" textpieces="1" top="313" width="324">fB(c) = 130.03  (100c)0.2369 (c=CPU util.) Beefy node power model</text>
1 <text font="6" height="9" left="84" textpieces="1" top="326" width="332">fW(c) = 10.994  (100c)0.2875 (c=CPU util.) Wimpy node power model</text>
1 <text font="6" height="9" left="92" textpieces="3" top="338" width="345">H = MW  (Bld  Bldsel)/(NB + NW) Wimpy can build the hash table</text>
2 <text font="3" height="12" left="168" textpieces="0" top="359" width="185">Table 3: List of Model Variables</text>
2 <text font="3" height="12" left="80" textpieces="0" top="387" width="359">validated against these results in Figure 7. This model enables us to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="402" width="359">freely explore the cluster and query parameters that are important</text>
2 <text font="3" height="12" left="81" textpieces="0" top="418" width="97">for cluster design.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="445" width="298">5.3  Modeling P-store and Bottlenecks</text>
2 <text font="3" height="12" left="94" textpieces="0" top="468" width="345">Our model of P-stores performance and energy consumption</text>
2 <text font="3" height="12" left="81" textpieces="0" top="484" width="359">behavior is aimed at understanding the nature of query parameters</text>
2 <text font="3" height="12" left="81" textpieces="0" top="499" width="359">and scalability bottlenecks affecting performance and system energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="515" width="361">consumption. The model predicts the performance and energy con-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="531" width="359">sumption of various different ways to execute a hash join. The input</text>
2 <text font="3" height="12" left="81" textpieces="0" top="547" width="263">parameters that we consider are listed in Table 3.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="562" width="345">From Table 3, note that our model makes a few simplifying</text>
2 <text font="3" height="12" left="81" textpieces="0" top="578" width="359">assumptions. First, the disk conguration for both the Wimpy nodes</text>
2 <text font="3" height="12" left="81" textpieces="0" top="594" width="361">and the Beefy nodes are the same and have the same bandwidth.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="609" width="359">Second, the same uniformity assumption has been made about the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="625" width="359">network capability of both node types. These assumptions matched</text>
2 <text font="3" height="12" left="81" textpieces="0" top="641" width="359">our hardware setup, but we can easily extend our model to account</text>
2 <text font="3" height="12" left="81" textpieces="0" top="656" width="254">for separate Wimpy and Beefy I/O bandwidths.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="672" width="345">First, let us look at when the Wimpy nodes can build hash tables</text>
2 <text font="3" height="12" left="81" textpieces="0" top="688" width="359">because they have enough memory to hold the hash tables (i.e., we</text>
2 <text font="3" height="12" left="81" textpieces="0" top="703" width="359">do not have to run a 2-pass hash join). This is the case when H is</text>
2 <text font="3" height="12" left="81" textpieces="0" top="719" width="97">true (see Table 3).</text>
2 <text font="3" height="12" left="94" textpieces="0" top="735" width="345">Homogeneous Execution: In this case, all the nodes execute the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="750" width="359">same operator tree. We can divide the hash join into the build phase</text>
2 <text font="3" height="12" left="81" textpieces="0" top="766" width="359">and the probe phase. During the build phase, we are either bound</text>
2 <text font="3" height="12" left="81" textpieces="0" top="782" width="359">by (1) the effects of the disk bandwidth and the selectivity on the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="798" width="229">build table ; or (2) the network bandwidth:</text>
2 <text font="6" height="9" left="117" textpieces="2" top="833" width="94">RBbld = RW bld=</text>
2 <text font="6" height="5" left="215" textpieces="0" top="818" width="11"></text>
2 <text font="6" height="5" left="215" textpieces="0" top="828" width="11"></text>
2 <text font="6" height="5" left="215" textpieces="0" top="847" width="11"></text>
2 <text font="6" height="9" left="292" textpieces="2" top="820" width="103">ISbld   if ISbld &lt; L</text>
2 <text font="6" height="9" left="240" textpieces="2" top="831" width="72">(NB + NW)L</text>
2 <text font="6" height="9" left="234" textpieces="2" top="847" width="84">(NB + NW  1)</text>
2 <text font="6" height="9" left="333" textpieces="0" top="839" width="41">otherwise</text>
2 <text font="3" height="12" left="94" textpieces="2" top="863" width="346">These two variables RBbldand RW bldgive us the rates at which</text>
2 <text font="3" height="12" left="81" textpieces="0" top="879" width="359">the build phase is proceeding (in MB/s). We also need to model the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="895" width="359">build phase CPU utilization to determine the power drawn by each</text>
2 <text font="3" height="12" left="81" textpieces="0" top="910" width="359">node type. This is done by determining the amount of data that the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="926" width="358">Beefy CPU and the Wimpy CPU is processing per second, UBbld</text>
2 <text font="3" height="12" left="81" textpieces="0" top="942" width="358">and UW bld, and then dividing each of these values by the maximum</text>
2 <text font="3" height="12" left="81" textpieces="2" top="957" width="358">measured rates for the CPU, CBand CW respectively. Finally, we</text>
2 <text font="3" height="12" left="81" textpieces="0" top="973" width="359">need to add CPU constants that are inherent to P-store, which are</text>
2 <text font="3" height="12" left="81" textpieces="2" top="988" width="359">EB and EW for the Beefy and Wimpy nodes respectively. This</text>
2 <text font="3" height="12" left="81" textpieces="1" top="1004" width="358">CPU utilization is the input for our server power functions, fBand</text>
2 <text font="3" height="12" left="81" textpieces="1" top="1020" width="341">fW, for the Beefy and Wimpy nodes respectively (see Table 3).</text>
2 <text font="6" height="9" left="99" textpieces="2" top="1058" width="93">UBbld = UW bld=</text>
2 <text font="6" height="5" left="196" textpieces="0" top="1044" width="11"></text>
2 <text font="6" height="5" left="196" textpieces="0" top="1053" width="11"></text>
2 <text font="6" height="5" left="196" textpieces="0" top="1072" width="11"></text>
2 <text font="6" height="9" left="331" textpieces="2" top="1045" width="81">I   if ISbld &lt; L</text>
2 <text font="6" height="9" left="221" textpieces="2" top="1057" width="72">(NB + NW)L</text>
2 <text font="6" height="9" left="215" textpieces="2" top="1072" width="84">(NB + NW  1)</text>
2 <text font="6" height="10" left="303" textpieces="1" top="1064" width="89"> Sbld   otherwise</text>
=============================== COL ===================================
2 <text font="4" height="10" left="658" textpieces="0" top="260" width="2"> </text>
2 <text font="4" height="10" left="487" textpieces="0" top="221" width="17">0.00</text>
2 <text font="4" height="10" left="487" textpieces="0" top="191" width="17">0.25</text>
2 <text font="4" height="10" left="487" textpieces="0" top="161" width="17">0.50</text>
2 <text font="4" height="10" left="487" textpieces="0" top="132" width="17">0.75</text>
2 <text font="4" height="10" left="487" textpieces="0" top="102" width="17">1.00</text>
2 <text font="4" height="9" left="520" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="522" textpieces="0" top="244" width="17">L 1%</text>
2 <text font="4" height="9" left="555" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="555" textpieces="0" top="244" width="22">L 10%</text>
2 <text font="4" height="9" left="591" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="591" textpieces="0" top="244" width="22">L 50%</text>
2 <text font="4" height="9" left="626" textpieces="0" top="233" width="22">O 1%,</text>
2 <text font="4" height="9" left="624" textpieces="0" top="244" width="26">L 100%</text>
2 <text font="6" height="10" left="483" textpieces="0" top="221" width="0">Normalized Response Time </text>
2 <text font="6" height="10" left="552" textpieces="0" top="255" width="77">Table Selectivities </text>
2 <text font="4" height="10" left="507" textpieces="1" top="90" width="127">Obs RT Ratio     Model RT Ratio</text>
2 <text font="4" height="10" left="838" textpieces="0" top="260" width="2"> </text>
2 <text font="4" height="10" left="667" textpieces="0" top="221" width="17">0.00</text>
2 <text font="4" height="10" left="667" textpieces="0" top="191" width="17">0.25</text>
2 <text font="4" height="10" left="667" textpieces="0" top="161" width="17">0.50</text>
2 <text font="4" height="10" left="667" textpieces="0" top="132" width="17">0.75</text>
2 <text font="4" height="10" left="667" textpieces="0" top="102" width="17">1.00</text>
2 <text font="4" height="9" left="700" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="702" textpieces="0" top="244" width="17">L 1%</text>
2 <text font="4" height="9" left="735" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="735" textpieces="0" top="244" width="22">L 10%</text>
2 <text font="4" height="9" left="770" textpieces="0" top="233" width="21">O 1%,</text>
2 <text font="4" height="9" left="770" textpieces="0" top="244" width="22">L 50%</text>
2 <text font="4" height="9" left="806" textpieces="0" top="233" width="22">O 1%,</text>
2 <text font="4" height="9" left="803" textpieces="0" top="244" width="26">L 100%</text>
2 <text font="6" height="10" left="662" textpieces="0" top="235" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="10" left="732" textpieces="0" top="255" width="77">Table Selectivities </text>
2 <text font="4" height="10" left="673" textpieces="1" top="90" width="154">Obs Energy Ratio   Model Energy Ratio</text>
2 <text font="3" height="12" left="561" textpieces="1" top="274" width="188">(a)                            (b)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="292" width="359">Figure 8: Performance and Energy model validation for the 2</text>
2 <text font="3" height="12" left="475" textpieces="2" top="307" width="359">Beefy/2 Wimpy case with 1%ORDERSselectivity and varying</text>
2 <text font="6" height="9" left="475" textpieces="1" top="325" width="340">LINEITEM selectivity against observed data from Figure 7(a)</text>
2 <text font="3" height="12" left="489" textpieces="0" top="355" width="345">Therefore, we can now calculate the build phase response time</text>
2 <text font="3" height="12" left="475" textpieces="0" top="371" width="259">and the build phase cluster energy consumption.</text>
2 <text font="6" height="9" left="565" textpieces="1" top="399" width="34">Tbld =</text>
2 <text font="6" height="9" left="645" textpieces="0" top="391" width="56">Bld  Sbld</text>
2 <text font="6" height="9" left="604" textpieces="2" top="407" width="139">(NBRBbld) + (NWRW bld)</text>
2 <text font="6" height="9" left="490" textpieces="4" top="430" width="148">Ebld= Tbld (NBfB(GB +</text>
2 <text font="6" height="9" left="642" textpieces="0" top="423" width="30">UBbld</text>
2 <text font="6" height="9" left="649" textpieces="0" top="438" width="17">CB</text>
2 <text font="6" height="9" left="675" textpieces="2" top="430" width="95">) + NWfW(GW +</text>
2 <text font="6" height="9" left="775" textpieces="0" top="423" width="33">UW bld</text>
2 <text font="6" height="9" left="781" textpieces="0" top="438" width="19">CW</text>
2 <text font="6" height="9" left="810" textpieces="0" top="430" width="9">))</text>
2 <text font="3" height="12" left="489" textpieces="0" top="458" width="345">Since this is homogeneous execution, the probe phase can be</text>
2 <text font="3" height="12" left="475" textpieces="0" top="473" width="359">modeled in the same way as the build phase but now using the probe</text>
2 <text font="3" height="12" left="475" textpieces="0" top="489" width="81">table variables.</text>
2 <text font="6" height="9" left="509" textpieces="2" top="524" width="98">RBprb = RW prb =</text>
2 <text font="6" height="5" left="610" textpieces="0" top="510" width="11"></text>
2 <text font="6" height="5" left="610" textpieces="0" top="519" width="11"></text>
2 <text font="6" height="5" left="610" textpieces="0" top="538" width="11"></text>
2 <text font="6" height="9" left="686" textpieces="2" top="511" width="106">ISprb   if ISprb &lt; L</text>
2 <text font="6" height="9" left="636" textpieces="2" top="523" width="71">(NB+ NW)L</text>
2 <text font="6" height="9" left="629" textpieces="2" top="538" width="85">(NB + NW  1)</text>
2 <text font="6" height="9" left="729" textpieces="0" top="530" width="41">otherwise</text>
2 <text font="3" height="12" left="489" textpieces="0" top="554" width="329">And similarly, the CPU bandwidth during the probe phase is:</text>
2 <text font="6" height="9" left="490" textpieces="2" top="589" width="97">UBprb = UW prb =</text>
2 <text font="6" height="5" left="590" textpieces="0" top="575" width="11"></text>
2 <text font="6" height="5" left="590" textpieces="0" top="584" width="11"></text>
2 <text font="6" height="5" left="590" textpieces="0" top="603" width="11"></text>
2 <text font="6" height="9" left="727" textpieces="2" top="576" width="83">I   if ISprb &lt; L</text>
2 <text font="6" height="9" left="616" textpieces="2" top="588" width="71">(NB+ NW)L</text>
2 <text font="6" height="9" left="609" textpieces="2" top="603" width="85">(NB + NW  1)</text>
2 <text font="6" height="10" left="698" textpieces="1" top="595" width="90"> Sprb   otherwise</text>
2 <text font="3" height="12" left="489" textpieces="0" top="619" width="347">Like the build phase, we can now calculate the probe phase re-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="635" width="330">sponse time and the probe phase cluster energy consumption.</text>
2 <text font="6" height="9" left="562" textpieces="1" top="663" width="36">Tprb =</text>
2 <text font="6" height="9" left="645" textpieces="0" top="655" width="58">P rb  Sprb</text>
2 <text font="6" height="9" left="603" textpieces="0" top="671" width="88">(NBRBprb) + (N</text>
2 <text font="11" height="7" left="693" textpieces="0" top="675" width="45">WRW prb</text>
2 <text font="6" height="9" left="741" textpieces="0" top="671" width="5">)</text>
2 <text font="6" height="9" left="486" textpieces="4" top="695" width="152">Eprb = Tprb (NBfB(GB +</text>
2 <text font="6" height="9" left="642" textpieces="0" top="687" width="32">UBprb</text>
2 <text font="6" height="9" left="650" textpieces="0" top="702" width="17">CB</text>
2 <text font="6" height="9" left="677" textpieces="2" top="695" width="95">) + NWfW(GW +</text>
2 <text font="6" height="9" left="776" textpieces="0" top="687" width="34">UW prb</text>
2 <text font="6" height="9" left="784" textpieces="0" top="702" width="19">CW</text>
2 <text font="6" height="9" left="813" textpieces="0" top="695" width="9">))</text>
2 <text font="3" height="12" left="489" textpieces="0" top="722" width="346">With these two phases modeled, the total response time is simply</text>
2 <text font="3" height="12" left="475" textpieces="2" top="737" width="323">Tbld+ Tprb, and the total energy consumed is Ebld+ Eprb.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="753" width="345">Heterogeneous Execution: When the Wimpy nodes can not</text>
2 <text font="3" height="12" left="475" textpieces="0" top="769" width="359">store the hash join hash table in memory (H is false), P-store uses</text>
2 <text font="3" height="12" left="475" textpieces="0" top="785" width="359">the Wimpy nodes as scan and lter nodes and only the Beefy nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="800" width="359">build the hash tables. Our model accounts for this by calculating the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="816" width="359">rates at which predicate-passing tuples are delivered to the Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="832" width="359">nodes. In the same spirit as the above model for the homogeneous</text>
2 <text font="3" height="12" left="475" textpieces="0" top="847" width="359">execution, the key factors are whether or not we are disk bound</text>
2 <text font="3" height="12" left="475" textpieces="0" top="863" width="359">or network bound. However, since a smaller set of Beefy nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="879" width="361">need to receive the data from the entire cluster, in addition to out-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="894" width="359">bound network limitations from nodes sending data, there is an</text>
2 <text font="3" height="12" left="475" textpieces="0" top="910" width="359">ingestion network limitation at the Beefy nodes, which becomes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="926" width="359">a performance bottleneck rst. That is, the Beefy nodes that are</text>
2 <text font="3" height="12" left="475" textpieces="0" top="942" width="359">building the hash tables can only receive data at the networks</text>
2 <text font="3" height="12" left="475" textpieces="0" top="957" width="359">capacity even though there may be many Wimpy nodes trying to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="359">send data to them at a higher rate. For heterogeneous execution, we</text>
2 <text font="3" height="12" left="475" textpieces="0" top="989" width="360">take this problem into account in our model. In the interest of space,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1004" width="192">we omit this model from this paper.</text>
2 <text font="9" height="14" left="479" textpieces="1" top="1030" width="164">5.3.1  Model Validation</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1051" width="345">Next, we present validation of our P-store model using the real</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">observed data of the 2 Beefy/2 Wimpy cluster in Section 5.2. Since</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="4" height="10" left="263" textpieces="0" top="260" width="2"> </text>
2 <text font="4" height="10" left="93" textpieces="0" top="221" width="17">0.00</text>
2 <text font="4" height="10" left="93" textpieces="0" top="191" width="17">0.25</text>
2 <text font="4" height="10" left="93" textpieces="0" top="161" width="17">0.50</text>
2 <text font="4" height="10" left="93" textpieces="0" top="132" width="17">0.75</text>
2 <text font="4" height="10" left="93" textpieces="0" top="102" width="17">1.00</text>
2 <text font="4" height="9" left="123" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="128" textpieces="0" top="244" width="17">L 1%</text>
2 <text font="4" height="9" left="158" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="161" textpieces="0" top="244" width="22">L 10%</text>
2 <text font="4" height="9" left="194" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="196" textpieces="0" top="244" width="22">L 50%</text>
2 <text font="4" height="9" left="229" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="229" textpieces="0" top="244" width="26">L 100%</text>
2 <text font="6" height="10" left="88" textpieces="0" top="221" width="0">Normalized Response Time </text>
2 <text font="6" height="10" left="158" textpieces="0" top="255" width="77">Table Selectivities </text>
2 <text font="4" height="10" left="112" textpieces="1" top="90" width="127">Obs RT Ratio     Model RT Ratio</text>
2 <text font="4" height="10" left="443" textpieces="0" top="260" width="2"> </text>
2 <text font="4" height="10" left="273" textpieces="0" top="221" width="17">0.00</text>
2 <text font="4" height="10" left="273" textpieces="0" top="191" width="17">0.25</text>
2 <text font="4" height="10" left="273" textpieces="0" top="161" width="17">0.50</text>
2 <text font="4" height="10" left="273" textpieces="0" top="132" width="17">0.75</text>
2 <text font="4" height="10" left="273" textpieces="0" top="102" width="17">1.00</text>
2 <text font="4" height="9" left="303" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="307" textpieces="0" top="244" width="17">L 1%</text>
2 <text font="4" height="9" left="338" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="340" textpieces="0" top="244" width="22">L 10%</text>
2 <text font="4" height="9" left="374" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="376" textpieces="0" top="244" width="22">L 50%</text>
2 <text font="4" height="9" left="409" textpieces="0" top="233" width="26">O 10%,</text>
2 <text font="4" height="9" left="409" textpieces="0" top="244" width="26">L 100%</text>
2 <text font="6" height="10" left="268" textpieces="0" top="235" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="10" left="337" textpieces="0" top="255" width="77">Table Selectivities </text>
2 <text font="4" height="10" left="279" textpieces="1" top="90" width="154">Obs Energy Ratio   Model Energy Ratio</text>
2 <text font="3" height="12" left="166" textpieces="1" top="274" width="189">(a)                            (b)</text>
2 <text font="3" height="12" left="81" textpieces="0" top="292" width="359">Figure 9: Performance and Energy model validation for the 2</text>
2 <text font="3" height="12" left="81" textpieces="2" top="307" width="358">Beefy/2 Wimpy case with 10%ORDERSselectivity and varying</text>
2 <text font="6" height="9" left="81" textpieces="1" top="325" width="341">LINEITEM selectivity against observed data from Figure 7(b)</text>
2 <text font="3" height="12" left="81" textpieces="0" top="356" width="359">the results in Section 5.2 were from warm-cache (some of the table</text>
2 <text font="3" height="12" left="81" textpieces="0" top="372" width="360">data resides in memory and disk I/O may be necessary) hash joins,</text>
2 <text font="3" height="12" left="80" textpieces="0" top="387" width="359">we changed the input parameters of our model to account for such</text>
2 <text font="3" height="12" left="81" textpieces="0" top="403" width="359">behavior. For example, we changed the scan rate of the build phase</text>
2 <text font="3" height="12" left="81" textpieces="2" top="419" width="360">to that of the maximum CPU bandwidth CWand CB. In this way,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="434" width="359">the time it takes to nish the build phase is equal to the time it takes</text>
2 <text font="3" height="12" left="81" textpieces="0" top="450" width="359">the CPU to process the build table at maximum speed plus the time</text>
2 <text font="3" height="12" left="81" textpieces="0" top="466" width="279">to send the lter qualifying tuples over the network.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="481" width="347">For our model, we used the following hardware parameter set-</text>
2 <text font="3" height="12" left="81" textpieces="5" top="497" width="360">tings: MB = 31000, MW = 7000, NB = NW = 2, I = 270, L = 95.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="513" width="359">Since our experiments used a different Beefy node (based on 2</text>
2 <text font="3" height="12" left="81" textpieces="1" top="528" width="358">L5630 Xeon CPUs) than the cluster-V nodes, the fBfunction for</text>
2 <text font="3" height="12" left="81" textpieces="3" top="544" width="353">node power is given by 79.006  (100  u)0.2451andCB= 4034.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="560" width="346">Our validation results of our model against the 2 Beefy/2 Wimpy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="576" width="359">cluster results from Section 5.2 are shown in Figures 8 and 9. In</text>
2 <text font="3" height="12" left="81" textpieces="0" top="591" width="361">Figure 8(a) and (b), we validate the response time and energy con-</text>
2 <text font="3" height="12" left="81" textpieces="2" top="607" width="360">sumption results of our model against the 1%ORDERStable selec-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="623" width="359">tivity joins presented in Figure 7(a). The execution plans for the</text>
2 <text font="3" height="12" left="80" textpieces="2" top="638" width="359">1%ORDERSselectivity were homogeneous across all the nodes. In</text>
2 <text font="3" height="12" left="81" textpieces="0" top="654" width="361">Figure 8, our model provided relative response time behavior and rel-</text>
2 <text font="3" height="12" left="81" textpieces="2" top="670" width="359">ative energy consumption behavior to the 100%LINEITEMselectivity</text>
2 <text font="3" height="12" left="81" textpieces="0" top="685" width="360">result within 5% error compared to the observed data. Similarly,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="701" width="359">in Figure 9(a) and (b), we validated the relative response time and</text>
2 <text font="3" height="12" left="81" textpieces="1" top="717" width="358">energy consumption results from our model for the 10%ORDERS</text>
2 <text font="3" height="12" left="81" textpieces="0" top="732" width="359">selectivity joins from Figure 7(b). Here the error rate was within</text>
2 <text font="3" height="12" left="80" textpieces="0" top="748" width="360">10% compared to the observed data. The execution plans here were</text>
2 <text font="3" height="12" left="81" textpieces="0" top="764" width="359">heterogeneous, with the Wimpy nodes only scanning and ltering</text>
2 <text font="3" height="12" left="81" textpieces="0" top="780" width="135">data for the Beefy nodes.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="795" width="345">With our model validated, we now explore a wider range of cluster</text>
2 <text font="3" height="12" left="81" textpieces="0" top="811" width="361">designs beyond four nodes while also varying the query parame-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="827" width="359">ters, such as predicate selectivity. Our results reveal interesting</text>
2 <text font="3" height="12" left="81" textpieces="0" top="842" width="259">opportunities for energy-efcient cluster design.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="872" width="358">5.4  Exploring Query and Cluster Parameters</text>
2 <text font="3" height="12" left="94" textpieces="0" top="894" width="345">In this section, we explore what happens to query performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="910" width="359">and energy consumption as we change the cluster design (the ratio</text>
2 <text font="3" height="12" left="81" textpieces="0" top="926" width="359">of Beefy to Wimpy nodes) and query characteristics (the selectivity</text>
2 <text font="3" height="12" left="81" textpieces="0" top="941" width="359">of build and probe tables), while executing the hash join query on</text>
2 <text font="3" height="12" left="81" textpieces="2" top="957" width="359">P-store. This hash join is between a 700GB TPC-HORDERStable</text>
2 <text font="3" height="12" left="81" textpieces="2" top="973" width="359">and 2.8TB TPC-HLINEITEMtable. We join these tables on their</text>
2 <text font="3" height="12" left="81" textpieces="1" top="988" width="359">join attributeORDERKEY. For our model, we used the following</text>
2 <text font="3" height="12" left="81" textpieces="3" top="1004" width="360">hardware parameter settings: MB= 47000, MW = 7000, I = 1200,</text>
2 <text font="6" height="9" left="81" textpieces="0" top="1022" width="359">L = 100. The memory settings correspond to those of our cluster-V</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1035" width="359">nodes (Table 1, Section 3) and Laptop B (Table 2). We model the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1051" width="359">IO subsystem of our nodes as if they each had four of the Crucial</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1067" width="359">256GB SSDs that we used in Section 5.2, as well as the 1Gbps</text>
=============================== COL ===================================
2 <text font="4" height="10" left="651" textpieces="0" top="266" width="2"> </text>
2 <text font="5" height="9" left="516" textpieces="0" top="99" width="26">8B,0W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="115" width="26">7B,1W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="130" width="26">6B,2W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="145" width="26">5B,3W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="161" width="26">4B,4W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="176" width="26">3B,5W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="191" width="26">2B,6W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="207" width="26">1B,7W </text>
2 <text font="5" height="9" left="516" textpieces="0" top="222" width="26">0B,8W </text>
2 <text font="5" height="9" left="488" textpieces="0" top="241" width="11">0.0</text>
2 <text font="5" height="9" left="488" textpieces="0" top="227" width="11">0.1</text>
2 <text font="5" height="9" left="488" textpieces="0" top="212" width="11">0.2</text>
2 <text font="5" height="9" left="488" textpieces="0" top="198" width="11">0.3</text>
2 <text font="5" height="9" left="488" textpieces="0" top="184" width="11">0.4</text>
2 <text font="5" height="9" left="488" textpieces="0" top="170" width="11">0.5</text>
2 <text font="5" height="9" left="488" textpieces="0" top="156" width="11">0.6</text>
2 <text font="5" height="9" left="488" textpieces="0" top="142" width="11">0.7</text>
2 <text font="5" height="9" left="488" textpieces="0" top="127" width="11">0.8</text>
2 <text font="5" height="9" left="488" textpieces="0" top="113" width="11">0.9</text>
2 <text font="5" height="9" left="488" textpieces="0" top="99" width="11">1.0</text>
2 <text font="5" height="9" left="630" textpieces="3" top="252" width="-115">0.70                    0.80                   0.90                    1.00</text>
2 <text font="6" height="11" left="483" textpieces="0" top="237" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="515" textpieces="0" top="261" width="114">Normalized  Performance </text>
2 <text font="6" height="11" left="506" textpieces="0" top="84" width="121">ORDERS 1%, LINEITEM 10% </text>
2 <text font="4" height="10" left="831" textpieces="0" top="266" width="2"> </text>
2 <text font="5" height="9" left="675" textpieces="0" top="129" width="26">8B,0W </text>
2 <text font="5" height="9" left="694" textpieces="0" top="145" width="26">7B,1W </text>
2 <text font="5" height="9" left="712" textpieces="0" top="119" width="26">6B,2W </text>
2 <text font="5" height="9" left="731" textpieces="0" top="146" width="26">5B,3W </text>
2 <text font="5" height="9" left="750" textpieces="0" top="126" width="26">4B,4W </text>
2 <text font="5" height="9" left="769" textpieces="0" top="138" width="26">3B,5W </text>
2 <text font="5" height="9" left="788" textpieces="0" top="189" width="26">2B,6W </text>
2 <text font="5" height="9" left="668" textpieces="0" top="241" width="11">0.9</text>
2 <text font="5" height="9" left="668" textpieces="0" top="145" width="11">1.0</text>
2 <text font="5" height="9" left="810" textpieces="3" top="252" width="-115">0.25                    0.50                   0.75                    1.00</text>
2 <text font="6" height="11" left="663" textpieces="0" top="245" width="0">Normalized Energy Consumption </text>
2 <text font="6" height="11" left="687" textpieces="0" top="261" width="111">Normalized Performance </text>
2 <text font="6" height="11" left="686" textpieces="0" top="84" width="126">ORDERS 10%, LINEITEM 10% </text>
2 <text font="3" height="12" left="561" textpieces="1" top="280" width="188">(a)                            (b)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="298" width="359">Figure 10: Modeled P-store dual-shufe hash join performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="314" width="359">and energy efciency of an 8 node cluster made of various Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="329" width="359">and Wimpy nodes. (a) Parallel execution is homogeneous: the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="345" width="360">Wimpy and Beefy nodes can build in-memory hash tables. (b)</text>
2 <text font="3" height="12" left="475" textpieces="0" top="361" width="361">Parallel execution is heterogeneous: Wimpy nodes scan and l-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="377" width="359">ter their local data before shufing it to the Beefy nodes for</text>
2 <text font="3" height="12" left="475" textpieces="0" top="392" width="359">further processing. A constant EDP relative to the all Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="408" width="198">cluster is shown by the dotted line.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="439" width="359">network interconnect of that experiment. We kept the remaining</text>
2 <text font="3" height="12" left="475" textpieces="0" top="455" width="278">CPU parameters the same as those listed in Table 3.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="471" width="345">We have already presented one of these results in Section 1. In</text>
2 <text font="3" height="12" left="475" textpieces="0" top="486" width="359">Figure 1(b), we showed that increasing the ratio of Wimpy to Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="502" width="359">nodes results in more energy-efcient congurations compared to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="518" width="359">the homogeneous cluster design consisting of only beefy nodes. In</text>
2 <text font="3" height="12" left="475" textpieces="0" top="533" width="359">that gure, we used the model that we described in Section 5.3 to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="549" width="359">compare the energy consumption vs. performance trade-off for the</text>
2 <text font="3" height="12" left="475" textpieces="4" top="565" width="359">hash join between the TPC-HORDERStable and theLINEITEMtable</text>
2 <text font="3" height="12" left="475" textpieces="0" top="580" width="210">at 10% and 1% selectivity respectively.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="596" width="345">In Figure 10(a), we show that the best cluster design point, when</text>
2 <text font="3" height="12" left="475" textpieces="2" top="612" width="359">executing a hash join between anORDERStable with 1% selectivity</text>
2 <text font="3" height="12" left="475" textpieces="2" top="627" width="360">and aLINEITEM table with 10% selectivity, is to use all Wimpy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="643" width="359">nodes. In this case, since a 1% selectivity on the hash join build</text>
2 <text font="3" height="12" left="475" textpieces="0" top="659" width="359">table means that each node only needs at least 875MB of memory to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="675" width="359">build in-memory hash tables, the parallel execution across all nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="690" width="359">is homogeneous. Since we have modeled the Wimpy and the Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="706" width="359">nodes to have the same IO and network capabilities, we should not</text>
2 <text font="3" height="12" left="475" textpieces="0" top="722" width="359">expect any performance degradation as we replace Beefy nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="737" width="359">with Wimpy nodes (i.e., the network and disk bottlenecks mask the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="753" width="359">performance limitations of the Wimpy nodes). This is shown in</text>
2 <text font="3" height="12" left="475" textpieces="0" top="769" width="359">Figure 10(a) as the performance ratio remains 1.0 throughout all the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="784" width="360">congurations. Consequently, since performance does not degrade,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="800" width="359">we see that the energy consumed by the hash join drops by almost</text>
2 <text font="3" height="12" left="475" textpieces="0" top="816" width="359">90% because a Wimpy node power footprint is almost 10% of the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="831" width="359">Beefy node power footprint. In the interest of space, we omit the</text>
2 <text font="3" height="12" left="475" textpieces="4" top="847" width="318">similar results for 1%ORDERSand 1%LINEITEMselectivity.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="863" width="345">In Figure 10(b), the best cluster conguration for a hash join when</text>
2 <text font="3" height="12" left="475" textpieces="2" top="879" width="359">theORDERStable has the same 10% selectivity as in Figure 1(b) and</text>
2 <text font="3" height="12" left="475" textpieces="2" top="894" width="361">theLINEITEMtable also has 10% selectivity is to use all Beefy nodes.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="910" width="359">The Wimpy nodes do not have the 8.8GB of main memory that is</text>
2 <text font="3" height="12" left="475" textpieces="0" top="926" width="359">needed to build the in-memory hash table, so we model them to scan</text>
2 <text font="3" height="12" left="475" textpieces="0" top="941" width="359">and lter data for the Beefy nodes; i.e., we have a heterogeneous</text>
2 <text font="3" height="12" left="475" textpieces="0" top="957" width="359">parallel execution. We varied the cluster design from the all Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="359">to 2 Beefy and 6 Wimpy cases, after which, the aggregate Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="988" width="359">memory cannot store the in-memory hash table. Here the results</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1004" width="359">stand in stark contrast to the results shown in Figure 10(a), because</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1020" width="359">there is not a signicant energy savings when we use Wimpy nodes</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="359">in the cluster. The reason is because with a 10% selectivity predicate</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1051" width="359">on the tables, the servers IO subsystem has enough bandwidth to</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">saturate the network interconnect, and the network becomes the</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="3" height="13" left="384" textpieces="0" top="280" width="3"> </text>
2 <text font="8" height="12" left="321" textpieces="0" top="238" width="22">EDP </text>
2 <text font="7" height="12" left="196" textpieces="0" top="101" width="35">7B,1W </text>
2 <text font="8" height="12" left="218" textpieces="0" top="125" width="35">6B,2W </text>
2 <text font="8" height="12" left="244" textpieces="0" top="103" width="35">5B,3W </text>
2 <text font="8" height="12" left="266" textpieces="0" top="126" width="35">4B,4W </text>
2 <text font="8" height="12" left="297" textpieces="0" top="105" width="35">3B,5W </text>
2 <text font="8" height="12" left="335" textpieces="0" top="112" width="35">2B,6W </text>
2 <text font="7" height="12" left="331" textpieces="0" top="127" width="42">   LI 10% </text>
2 <text font="8" height="12" left="334" textpieces="0" top="143" width="28">LI 8% </text>
2 <text font="8" height="12" left="323" textpieces="0" top="166" width="28">LI 6% </text>
2 <text font="8" height="12" left="297" textpieces="0" top="196" width="28">LI 4% </text>
2 <text font="8" height="12" left="158" textpieces="0" top="103" width="35">8B,0W </text>
2 <text font="8" height="12" left="255" textpieces="0" top="234" width="28">LI 2% </text>
2 <text font="8" height="12" left="158" textpieces="0" top="245" width="15">0.4</text>
2 <text font="8" height="12" left="158" textpieces="0" top="203" width="15">0.6</text>
2 <text font="8" height="12" left="158" textpieces="0" top="160" width="15">0.8</text>
2 <text font="7" height="12" left="158" textpieces="0" top="118" width="15">1.0</text>
2 <text font="8" height="12" left="360" textpieces="2" top="260" width="-168">0.2                       0.6                       1.0</text>
2 <text font="3" height="13" left="203" textpieces="0" top="274" width="138">Normalized Performance </text>
2 <text font="2" height="14" left="190" textpieces="0" top="85" width="158">Hash Join: Orders 10% Sel. </text>
2 <text font="3" height="13" left="151" textpieces="0" top="263" width="0">Normalized Energy Consumption </text>
2 <text font="3" height="12" left="81" textpieces="0" top="297" width="359">Figure 11: Modeled P-store dual-shufe hash join performance</text>
2 <text font="3" height="12" left="81" textpieces="0" top="313" width="359">and energy efciency of an 8 node cluster made of Beefy and</text>
2 <text font="3" height="12" left="81" textpieces="2" top="329" width="358">Wimpy nodes. The join is between the TPC-HORDERStable</text>
2 <text font="3" height="12" left="80" textpieces="2" top="344" width="359">(10% sel.) andLINEITEMtable (2-10% sel.). Parallel execution</text>
2 <text font="3" height="12" left="81" textpieces="0" top="360" width="359">is heterogeneous across cluster nodes. A constant EDP relative</text>
2 <text font="3" height="12" left="81" textpieces="0" top="376" width="335">to the all Beefy cluster is shown by the straight dotted line.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="404" width="361">bottleneck. Specically, as we decrease the number of Beefy nodes </text>
2 <text font="3" height="12" left="81" textpieces="0" top="420" width="359">they are responsible for building and probing the hash tables  each</text>
2 <text font="3" height="12" left="81" textpieces="0" top="436" width="359">Beefy node becomes more network bottlenecked ingesting data</text>
2 <text font="3" height="12" left="81" textpieces="0" top="451" width="359">from all the other nodes in the cluster. Consequently, we see that</text>
2 <text font="3" height="12" left="81" textpieces="0" top="467" width="359">the performance degrades severely, while the energy consumption</text>
2 <text font="3" height="12" left="81" textpieces="0" top="483" width="341">does not drop below 95% of the 8B,0W cluster reference point.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="498" width="345">This last result is interesting because we saw that for another</text>
2 <text font="3" height="12" left="81" textpieces="2" top="514" width="361">heterogeneous execution plan in Figure 1(b), a 1%LINEITEMse-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="530" width="359">lectivity, saw signicant wins in trading performance for energy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="545" width="361">savings. Naturally, we wanted to understand why we saw these dif-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="561" width="359">ferent results when we only change the selectivities of the predicate</text>
2 <text font="3" height="12" left="81" textpieces="2" top="577" width="119">on theLINEITEMtable.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="592" width="345">In Figure 11, we show that as we increase the selectivities of the</text>
2 <text font="3" height="12" left="81" textpieces="2" top="608" width="360">predicate on theLINEITEMtable from 10% to 2% (in 2% increments),</text>
2 <text font="3" height="12" left="81" textpieces="2" top="624" width="358">given a 10% selectivity predicate on theORDERStable, we begin</text>
2 <text font="3" height="12" left="81" textpieces="0" top="639" width="359">to trade less performance for greater energy savings. Each curve</text>
2 <text font="3" height="12" left="81" textpieces="2" top="655" width="358">represents a differentLINEITEMselectivity, and as the curve moves</text>
2 <text font="3" height="12" left="81" textpieces="0" top="671" width="359">to the right, each dot indicates more Wimpy nodes in the 8 node</text>
2 <text font="3" height="12" left="81" textpieces="0" top="687" width="359">cluster. Again, we do not use fewer than 2 Beefy nodes because</text>
2 <text font="3" height="12" left="80" textpieces="0" top="702" width="360">1 Beefy node cannot build the entire hash table in memory. The</text>
2 <text font="3" height="12" left="81" textpieces="0" top="718" width="250">dashed line indicates the constant EDP metric.</text>
2 <text font="3" height="12" left="94" textpieces="1" top="734" width="345">We notice that as we gradually decrease the number ofLINEITEM</text>
2 <text font="3" height="12" left="81" textpieces="2" top="749" width="359">tuples passing the selection lter (i.e., increase theLINEITEMtable</text>
2 <text font="3" height="12" left="81" textpieces="0" top="765" width="361">selectivity from 10% to 2%), the results start to trend downward be-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="781" width="359">low the EDP line. More interestingly, we notice that the results start</text>
2 <text font="3" height="12" left="81" textpieces="0" top="796" width="359">to trend downward in a way such that the knee in the curves moves</text>
2 <text font="3" height="12" left="81" textpieces="0" top="812" width="359">lower towards the cluster designs with more Wimpy nodes (right</text>
2 <text font="3" height="12" left="81" textpieces="0" top="828" width="359">ends of the result curves). To the right of the knee, the heterogeneous</text>
2 <text font="3" height="12" left="81" textpieces="0" top="844" width="359">parallel plans saturate the Beefy node network ingestion during the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="859" width="358">probe phase. To the left of the knee, the nodes delivering data to the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="875" width="359">Beefy nodes are sending data as fast as their IO subsystem (and table</text>
2 <text font="3" height="12" left="81" textpieces="0" top="891" width="359">selectivity) can sustain. As the amount of probe (LINEITEM) data</text>
2 <text font="3" height="12" left="81" textpieces="0" top="906" width="359">passing the selection lter decreases (the gradually lighter-shaded</text>
2 <text font="3" height="12" left="81" textpieces="0" top="922" width="359">curves in Figure 11), the number of Wimpy nodes that are needed</text>
2 <text font="3" height="12" left="81" textpieces="0" top="938" width="360">to saturate the inbound network port at the Beefy nodes increases,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="953" width="323">so the knee moves to the right end with more Wimpy nodes.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="981" width="116">5.5  Summary</text>
2 <text font="3" height="12" left="94" textpieces="0" top="1004" width="347">In this section, we have shown that there is an interesting inter-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1020" width="359">play between the most energy-efcient cluster design (the ratio of</text>
2 <text font="3" height="12" left="80" textpieces="0" top="1035" width="359">Wimpy to Beefy nodes) and the query parameters such as predicate</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1051" width="361">selectivity (Figure 11) for a simple parallel hash join query. Further-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="1067" width="359">more, heterogeneous cluster designs can trade proportionally less</text>
=============================== COL ===================================
2 <text font="6" height="11" left="535" textpieces="0" top="214" width="111">Normalized Performance </text>
2 <text font="6" height="11" left="500" textpieces="0" top="198" width="0">Normalized Energy </text>
2 <text font="6" height="11" left="513" textpieces="0" top="186" width="0">Consumption </text>
2 <text font="9" height="17" left="576" textpieces="0" top="92" width="22">(a) </text>
2 <text font="8" height="12" left="535" textpieces="0" top="116" width="98">8N  6N  4N  2N </text>
2 <text font="6" height="11" left="699" textpieces="0" top="214" width="111">Normalized Performance </text>
2 <text font="9" height="17" left="740" textpieces="0" top="93" width="22">(b) </text>
2 <text font="8" height="12" left="697" textpieces="0" top="116" width="90">8N  6N  4N  2N </text>
2 <text font="8" height="12" left="564" textpieces="0" top="244" width="34">8B,0W </text>
2 <text font="8" height="12" left="610" textpieces="0" top="273" width="34">6B,2W </text>
2 <text font="8" height="12" left="629" textpieces="0" top="291" width="34">4B,4W </text>
2 <text font="8" height="12" left="658" textpieces="0" top="317" width="34">2B,6W </text>
2 <text font="8" height="12" left="630" textpieces="1" top="246" width="86">6B,0W     4B,0W </text>
2 <text font="8" height="12" left="729" textpieces="0" top="276" width="34">2B,0W </text>
2 <text font="8" height="12" left="565" textpieces="0" top="343" width="15">0.2</text>
2 <text font="8" height="12" left="565" textpieces="0" top="321" width="15">0.4</text>
2 <text font="8" height="12" left="565" textpieces="0" top="299" width="15">0.6</text>
2 <text font="8" height="12" left="565" textpieces="0" top="277" width="15">0.8</text>
2 <text font="8" height="12" left="565" textpieces="0" top="255" width="15">1.0</text>
2 <text font="8" height="12" left="758" textpieces="2" top="358" width="-160">0.2                      0.6                      1.0</text>
2 <text font="6" height="11" left="547" textpieces="0" top="341" width="0">Normalized Energy </text>
2 <text font="6" height="11" left="560" textpieces="0" top="329" width="0">Consumption </text>
2 <text font="6" height="11" left="607" textpieces="0" top="368" width="111">Normalized Performance </text>
2 <text font="3" height="13" left="566" textpieces="1" top="230" width="-25">Hash Join: Orders 10% Lineitem 2%                                           (c) </text>
2 <text font="8" height="12" left="697" textpieces="3" top="205" width="-44">1.0                   0.2                                                               1.0                   0.2 </text>
2 <text font="8" height="12" left="515" textpieces="0" top="199" width="18">0.2 </text>
2 <text font="8" height="12" left="514" textpieces="0" top="126" width="18">1.0 </text>
2 <text font="8" height="12" left="677" textpieces="0" top="198" width="18">0.2 </text>
2 <text font="8" height="12" left="676" textpieces="0" top="126" width="18">1.0 </text>
2 <text font="8" height="12" left="585" textpieces="1" top="206" width="179">0.6                                0.6 </text>
2 <text font="4" height="10" left="542" textpieces="0" top="173" width="47">Best Design </text>
2 <text font="4" height="10" left="542" textpieces="0" top="184" width="22">Point </text>
2 <text font="4" height="10" left="704" textpieces="0" top="173" width="47">Best Design </text>
2 <text font="4" height="10" left="704" textpieces="0" top="184" width="22">Point </text>
2 <text font="4" height="10" left="696" textpieces="0" top="294" width="58">Homogeneous </text>
2 <text font="4" height="10" left="696" textpieces="0" top="305" width="69">Best Design Point </text>
2 <text font="4" height="10" left="598" textpieces="0" top="326" width="61">Heterogeneous </text>
2 <text font="4" height="10" left="598" textpieces="0" top="337" width="69">Best Design Point </text>
2 <text font="6" height="11" left="662" textpieces="0" top="198" width="0">Normalized Energy </text>
2 <text font="6" height="11" left="675" textpieces="0" top="186" width="0">Consumption </text>
2 <text font="3" height="12" left="475" textpieces="0" top="399" width="361">Figure 12: Query scalability characterizations and energy-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="415" width="359">efcient design points when the target query performance is</text>
2 <text font="3" height="12" left="475" textpieces="0" top="430" width="361">40% of an eight Beefy node conguration, i.e., the target nor-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="446" width="361">malized performance is 0.6: (a) A highly scalable parallel work-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="462" width="361">load: Use all available nodes, since the highest performing de-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="477" width="361">sign point is also the most energy efcient. (b) A parallel work-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="493" width="359">load with some scalability bottleneck (e.g., network I/O): Use</text>
2 <text font="3" height="12" left="475" textpieces="0" top="509" width="361">the fewest nodes such that performance limits are still met.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="524" width="361">(c) Using fewer nodes reduces energy consumption on bottle-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="540" width="359">necked hash join but adding Wimpy nodes to supplement Beefy</text>
2 <text font="3" height="12" left="475" textpieces="0" top="556" width="359">nodes can provide a more energy-efcient design point. The</text>
2 <text font="3" height="12" left="475" textpieces="0" top="571" width="359">dashed EDP curve provides a reference for equal performance</text>
2 <text font="3" height="12" left="475" textpieces="0" top="587" width="117">vs energy trade-offs.</text>
2 <text font="3" height="12" left="475" textpieces="0" top="619" width="359">performance for greater energy savings (i.e., they lie below the EDP</text>
2 <text font="3" height="12" left="475" textpieces="0" top="634" width="263">line) compared to a homogeneous cluster design.</text>
2 <text font="1" height="16" left="475" textpieces="1" top="668" width="303">6.  CLUSTER DESIGN PRINCIPLES</text>
2 <text font="3" height="12" left="489" textpieces="0" top="690" width="345">In this section we summarize guiding principles for building</text>
2 <text font="3" height="12" left="475" textpieces="0" top="706" width="359">energy-efcient data processing clusters. Figure 12 outlines the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="722" width="315">summary of our ndings, which we discuss in this section.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="737" width="347">First, consider a query that is being run on a parallel data pro-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="753" width="359">cessing system. Using initial hardware calibration data and query</text>
2 <text font="3" height="12" left="475" textpieces="0" top="769" width="359">optimizer information, consider the case when the query is deemed</text>
2 <text font="3" height="12" left="475" textpieces="0" top="784" width="359">to be highly scalable. That is, the energy/performance model for</text>
2 <text font="3" height="12" left="475" textpieces="0" top="800" width="359">the query looks like Figure 12(a). (We have seen empirical results</text>
2 <text font="3" height="12" left="475" textpieces="0" top="816" width="359">like this, in Figures 2(a) and (b).) For such queries, the best cluster</text>
2 <text font="3" height="12" left="475" textpieces="0" top="831" width="359">design point is to use the most resources (nodes) to nish the query</text>
2 <text font="3" height="12" left="475" textpieces="0" top="847" width="359">as soon as possible. So, in Figure 12(a), we nd that the largest</text>
2 <text font="3" height="12" left="475" textpieces="0" top="863" width="166">cluster is the best design point.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="879" width="347">However, if the query is not scalable (potentially due to bottle-</text>
2 <text font="3" height="12" left="475" textpieces="0" top="894" width="359">necks), then the highest performing cluster design may not be the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="910" width="360">most energy-efcient design. (The results shown in Figures 1(a), 3,</text>
2 <text font="3" height="12" left="475" textpieces="0" top="926" width="359">and 4 are examples of this case.) For such queries, reducing the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="941" width="359">cluster size decreases the query energy consumption, although at</text>
2 <text font="3" height="12" left="475" textpieces="0" top="957" width="359">the cost of performance. In such situations, one should reduce the</text>
2 <text font="3" height="12" left="475" textpieces="0" top="973" width="359">performance to meet any required target (e.g., performance targets</text>
2 <text font="3" height="12" left="475" textpieces="0" top="988" width="359">specied in SLAs in cloud environments). Then, the system can</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1004" width="359">reduce the server resource allocation accordingly. Thus, as we show</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1020" width="359">in Figure 12(b), if the acceptable performance loss is 40%, then</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1035" width="318">using 4 nodes is the best cluster design point for this query.</text>
2 <text font="3" height="12" left="489" textpieces="0" top="1051" width="345">Finally, these previous design principles assume a homogeneous</text>
2 <text font="3" height="12" left="475" textpieces="0" top="1067" width="359">cluster. For queries that are not scalable, a heterogeneous cluster</text>
=============================== PAGE ===================================
=============================== COL ===================================
2 <text font="3" height="12" left="81" textpieces="0" top="87" width="360">may provide an interesting design point. As before, in this case,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="102" width="359">to pick a good cluster design point, we start with an acceptable</text>
2 <text font="3" height="12" left="81" textpieces="0" top="118" width="359">target performance. Then, heterogeneous cluster congurations may</text>
2 <text font="3" height="12" left="81" textpieces="0" top="134" width="361">provide a better cluster design point compared to the best homoge-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="149" width="359">neous cluster conguration. As an example, consider the P-store</text>
2 <text font="3" height="12" left="81" textpieces="0" top="165" width="359">dual-shufe hash join query in Figure 12(c), and an acceptable</text>
2 <text font="3" height="12" left="81" textpieces="0" top="181" width="361">performance loss of 40% relative to an eight Beefy node homo-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="196" width="359">geneous cluster design (labeled as 8B in the Figure). Here, the 5B</text>
2 <text font="3" height="12" left="81" textpieces="0" top="212" width="359">conguration is the best homogeneous cluster design point. But if</text>
2 <text font="3" height="12" left="80" textpieces="0" top="228" width="362">we substitute some of the Beefy nodes with lower-powered Wimpy</text>
2 <text font="3" height="12" left="81" textpieces="0" top="243" width="359">nodes then with two Beefy nodes and six Wimpy nodes we consume</text>
2 <text font="3" height="12" left="81" textpieces="0" top="259" width="361">less energy than the 5B case and also have better query performance.</text>
2 <text font="3" height="12" left="81" textpieces="0" top="275" width="359">Notice that the heterogeneous design points are below the EDP</text>
2 <text font="3" height="12" left="81" textpieces="0" top="291" width="359">curve, which means that in these designs one proportionally saved</text>
2 <text font="3" height="12" left="81" textpieces="0" top="306" width="359">more energy than the proportional performance loss (compared</text>
2 <text font="3" height="12" left="81" textpieces="0" top="322" width="359">to the 8B case). Thus, for non-scalable queries, a heterogeneous</text>
2 <text font="3" height="12" left="81" textpieces="0" top="338" width="359">cluster conguration may provide a better design point, both from</text>
2 <text font="3" height="12" left="81" textpieces="0" top="353" width="359">the energy efciency and performance perspective, compared to</text>
2 <text font="3" height="12" left="81" textpieces="0" top="369" width="161">homogeneous cluster designs.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="385" width="345">Note, the work in this paper has focused on single queries. We</text>
2 <text font="3" height="12" left="81" textpieces="0" top="400" width="359">acknowledge that to make these results more meaningful, we need</text>
2 <text font="3" height="12" left="81" textpieces="0" top="416" width="359">to expand the study to include entire workloads, and to consider</text>
2 <text font="3" height="12" left="81" textpieces="0" top="432" width="359">the overall cost of using only part of a cluster for a portion of the</text>
2 <text font="3" height="12" left="80" textpieces="0" top="447" width="359">workload. In other words, we acknowledge that additional work is</text>
2 <text font="3" height="12" left="81" textpieces="0" top="463" width="359">needed to produce a complete practical solution. But, we hope the</text>
2 <text font="3" height="12" left="81" textpieces="0" top="479" width="359">insights in this paper provide a good starting point to seed future</text>
2 <text font="3" height="12" left="81" textpieces="0" top="494" width="111">research in this area.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="527" width="347">7.  CONCLUSIONS AND FUTURE WORK</text>
2 <text font="3" height="12" left="94" textpieces="0" top="550" width="347">In this paper, we have studied the trade-offs between the per-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="565" width="359">formance and the energy consumption characteristics of analytical</text>
2 <text font="3" height="12" left="81" textpieces="0" top="581" width="359">queries, for various cluster designs. We have found that the query</text>
2 <text font="3" height="12" left="81" textpieces="0" top="597" width="361">scalability properties have a key impact in determining the interac-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="613" width="359">tion between the query performance and its energy consumption</text>
2 <text font="3" height="12" left="81" textpieces="0" top="628" width="359">characteristics. We have summarized our ndings (in Section 6) as</text>
2 <text font="3" height="12" left="81" textpieces="0" top="644" width="361">initial guiding principles for building energy-efcient data process-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="660" width="65">ing clusters.</text>
2 <text font="3" height="12" left="94" textpieces="0" top="675" width="347">There are a number of directions for future work, including ex-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="691" width="361">panding this work to consider entire workloads, exploring heteroge-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="707" width="360">neous execution plans to take advantage of heterogeneous clusters,</text>
2 <text font="3" height="12" left="81" textpieces="0" top="722" width="359">examining the impact of data skew, and investigating the impact of</text>
2 <text font="3" height="12" left="81" textpieces="0" top="738" width="232">dynamically varying multi-user workloads.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="771" width="240">8.  ACKNOWLEDGEMENTS</text>
2 <text font="3" height="12" left="94" textpieces="0" top="793" width="347">We thank David DeWitt, Jeffrey Naughton, Alan Halverson, Spy-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="809" width="359">ros Blanas, and Avrilia Floratou for their valuable input on this</text>
2 <text font="3" height="12" left="80" textpieces="0" top="825" width="359">work. Part of this work was completed while Willis Lang, Stavros</text>
2 <text font="3" height="12" left="81" textpieces="0" top="840" width="359">Harizopoulos, and Mehul Shah worked at HP Labs. This research</text>
2 <text font="3" height="12" left="80" textpieces="0" top="856" width="361">was supported in part by a grant from the Microsoft Jim Gray Sys-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="872" width="361">tems Lab and by the National Science Foundation under grant IIS-</text>
2 <text font="3" height="12" left="81" textpieces="0" top="888" width="50">0963993.</text>
2 <text font="1" height="16" left="81" textpieces="1" top="920" width="152">9.  REFERENCES</text>
2 <text font="6" height="9" left="86" textpieces="0" top="938" width="289">[1] http://www.oracle.com/us/products/database/</text>
2 <text font="6" height="8" left="105" textpieces="0" top="950" width="281">exadata-database-machine/overview/index.html.</text>
2 <text font="6" height="9" left="86" textpieces="0" top="963" width="160">[2] http://www.netezza.com.</text>
2 <text font="6" height="9" left="86" textpieces="0" top="977" width="160">[3] http://www.vertica.com.</text>
2 <text font="6" height="9" left="86" textpieces="0" top="990" width="279">[4] http://www.actian.com/products/vectorwise.</text>
2 <text font="6" height="9" left="86" textpieces="0" top="1003" width="289">[5] http://h18013.www1.hp.com/products/servers/</text>
2 <text font="6" height="8" left="105" textpieces="0" top="1016" width="166">management/remotemgmt.html.</text>
2 <text font="6" height="9" left="86" textpieces="0" top="1029" width="347">[6] A. Abouzeid, K. Bajda-Pawlikowski, D. Abadi, A. Silberschatz, and A. Rasin.</text>
2 <text font="6" height="9" left="105" textpieces="0" top="1041" width="318">Hadoopdb: an architectural hybrid of mapreduce and dbms technologies for</text>
2 <text font="6" height="9" left="105" textpieces="0" top="1053" width="227">analytical workloads. In VLDB, pages 922933, 2009.</text>
=============================== COL ===================================
2 <text font="6" height="9" left="480" textpieces="0" top="89" width="332">[7] H. Amur, J. Cipar, V. Gupta, G. R. Ganger, M. A. Kozuch, and K. Schwan.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="101" width="335">Robust and exible power-proportional storage. In SoCC, pages 217228, 2010.</text>
2 <text font="6" height="9" left="480" textpieces="0" top="112" width="319">[8] D. G. Andersen, J. Franklin, M. Kaminsky, A. Phanishayee, L. Tan, and</text>
2 <text font="6" height="9" left="499" textpieces="0" top="124" width="329">V. Vasudevan. Fawn: a fast array of wimpy nodes. In SOSP, pages 114, 2009.</text>
2 <text font="6" height="9" left="480" textpieces="0" top="137" width="337">[9] L. A. Barroso and U. Holzle. The Case for Energy-Proportional Computing.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="149" width="158">IEEE Computer, 40(12):3337, 2007.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="162" width="359">[10] L. A. Barroso and U. Holzle. The Datacenter as a Computer: An Introduction to</text>
2 <text font="6" height="9" left="499" textpieces="0" top="174" width="315">the Design of Warehouse-Scale Machines. Synthesis Lectures on Computer</text>
2 <text font="6" height="9" left="499" textpieces="0" top="187" width="80">Architecture, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="200" width="322">[11] Y. Chen, S. Alspaugh, D. Borthakur, and R. Katz. Energy efciency for</text>
2 <text font="6" height="9" left="499" textpieces="0" top="212" width="304">large-scale mapreduce workloads with signicant interactive analysis. In</text>
2 <text font="6" height="9" left="499" textpieces="0" top="224" width="121">EuroSys, pages 4556, 2012.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="237" width="320">[12] D. DeWitt and J. Gray. Parallel Database Systems: The Future of High</text>
2 <text font="6" height="9" left="499" textpieces="0" top="249" width="262">Performance Database Processing. CACM, 35(6):8598, 1992.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="263" width="275">[13] Google Inc. Efciency measurements - Google Datacenters.</text>
2 <text font="6" height="8" left="499" textpieces="0" top="275" width="270">http://www.google.com/corporate/datacenter/</text>
2 <text font="6" height="8" left="499" textpieces="0" top="287" width="179">efficiency-measurements.html.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="300" width="359">[14] G. Graefe. Database Servers Tailored to Improve Energy Efciency. In Software</text>
2 <text font="6" height="9" left="499" textpieces="0" top="312" width="230">Engineering for Tailor-made Data Management, 2008.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="325" width="344">[15] J. Hamilton. Where Does the Power go in DCs &amp; How to get it Back. In Foo</text>
2 <text font="6" height="9" left="499" textpieces="0" top="337" width="300">Camp, http://www.mvdirona.com/jrh/TalksAndPapers/</text>
2 <text font="6" height="8" left="499" textpieces="0" top="350" width="249">JamesRH_DCPowerSavingsFooCamp08.ppt, 2008.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="363" width="352">[16] S. Harizopoulos, V. Liang, D. J. Abadi, and S. Madden. Performance tradeoffs</text>
2 <text font="6" height="9" left="499" textpieces="0" top="375" width="257">in read-optimized databases. In VLDB, pages 487498, 2006.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="388" width="307">[17] S. Harizopoulos and S. Papadimitriou. A Case for Micro-cellstores:</text>
2 <text font="6" height="9" left="499" textpieces="0" top="400" width="313">Energy-Efcient Data Management on Recycled Smartphones. In DaMoN,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="412" width="81">pages 5055, 2011.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="426" width="354">[18] S. Harizopoulos, M. A. Shah, J. Meza, and P. Ranganathan. Energy Efciency:</text>
2 <text font="6" height="9" left="499" textpieces="0" top="437" width="318">The New Holy Grail of Database Management Systems Research. In CIDR,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="449" width="24">2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="463" width="307">[19] J. G. Koomey. Growth in Data Center Electricity Use 2005 to 2010.</text>
2 <text font="6" height="8" left="499" textpieces="0" top="475" width="289">http://www.mediafire.com/file/zzqna34282frr2f/</text>
2 <text font="6" height="8" left="499" textpieces="0" top="487" width="305">koomeydatacenterelectuse2011finalversion.pdf, 2011.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="500" width="345">[20] A. Krioukov, C. Goebel, S. Alspaugh, Y. Chen, D. E. Culler, and R. H. Katz.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="512" width="313">Integrating renewable energy using data analytics systems: Challenges and</text>
2 <text font="6" height="9" left="499" textpieces="0" top="524" width="232">opportunities. IEEE Data Eng. Bull., 34(1):311, 2011.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="538" width="358">[21] W. Lang, R. Kandhan, and J. M. Patel. Rethinking Query Processing for Energy</text>
2 <text font="6" height="9" left="499" textpieces="0" top="550" width="336">Efciency: Slowing Down to Win the Race. IEEE Data Eng. Bull., 34(1):1223,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="562" width="24">2011.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="575" width="359">[22] W. Lang and J. M. Patel. Towards Eco-friendly Database Management Systems.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="587" width="64">In CIDR, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="600" width="336">[23] W. Lang and J. M. Patel. Energy Management for MapReduce Clusters. In</text>
2 <text font="6" height="9" left="499" textpieces="0" top="612" width="123">VLDB, pages 129139, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="626" width="328">[24] W. Lang, J. M. Patel, and J. F. Naughton. On Energy Management, Load</text>
2 <text font="6" height="9" left="499" textpieces="0" top="638" width="274">Balancing and Replication. SIGMOD Record, 38(4):3542, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="651" width="333">[25] W. Lang, J. M. Patel, and S. Shankar. Wimpy Node Clusters: What About</text>
2 <text font="6" height="9" left="499" textpieces="0" top="663" width="240">Non-Wimpy Workloads? In DaMoN, pages 4755, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="677" width="347">[26] J. Larkby-Lahet, G. Santhanakrishnan, A. Amer, and P. K. Chrysanthis. Step:</text>
2 <text font="6" height="9" left="499" textpieces="0" top="689" width="281">Self-tuning energy-safe predictors. In MDM, pages 125133, 2005.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="702" width="350">[27] J. Leverich and C. Kozyrakis. On the energy (in)efciency of hadoop clusters.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="714" width="189">SIGOPS Oper. Syst. Rev., 44(1):6165, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="727" width="349">[28] J. Meza, M. A. Shah, P. Ranganathan, M. Fitzner, and J. Veazay. Tracking the</text>
2 <text font="6" height="9" left="499" textpieces="0" top="739" width="318">power in an enterprise decision support system. In ISLPED, pages 261266,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="751" width="24">2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="765" width="348">[29] R. Mueller, J. Teubner, and G. Alonso. Data Processing on FPGAs. In VLDB,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="777" width="92">pages 910921, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="790" width="320">[30] D. A. Patteron. Latency Lags Bandwidth. CACM, 47(10):7175, 2004.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="804" width="334">[31] A. Pavlo, E. Paulson, A. Rasin, D. J. Abadi, D. J. DeWitt, S. Madden, and</text>
2 <text font="6" height="9" left="499" textpieces="0" top="816" width="334">M. Stonebraker. A Comparison of Approaches to Large-Scale Data Analysis. In</text>
2 <text font="6" height="9" left="499" textpieces="0" top="828" width="137">SIGMOD, pages 165178, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="841" width="355">[32] R. Raghavendra, P. Ranganathan, V. Talwar, Z. Wang, and X. Zhu. No power</text>
2 <text font="6" height="9" left="499" textpieces="0" top="853" width="306">struggles: coordinated multi-level power management for the data center.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="865" width="189">SIGOPS Oper. Syst. Rev., 42(2):4859, 2008.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="878" width="328">[33] A. S. Szalay, G. Bell, H. H. Huang, A. Terzis, and A. White. Low-Power</text>
2 <text font="6" height="9" left="499" textpieces="0" top="890" width="323">Amdahl-Balanced Blades for Data Intensive Computing. SIGOPS Oper. Syst.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="902" width="103">Rev., 44(1):7175, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="916" width="317">[34] N. Tolia, Z. Wang, M. Marwah, C. Bash, P. Ranganathan, and X. Zhu.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="928" width="317">Delivering Energy Proportionality with Non Energy-Proportional Systems -</text>
2 <text font="6" height="9" left="499" textpieces="0" top="940" width="194">Optimizing the Ensemble. In HotPower, 2008.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="953" width="328">[35] D. Tsirogiannis, S. Harizopoulos, and M. A. Shah. Analyzing the energy</text>
2 <text font="6" height="9" left="499" textpieces="0" top="965" width="279">efciency of a database server. In SIGMOD, pages 231242, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="978" width="348">[36] V. Vasudevan, D. Andersen, M. Kaminsky, L. Tan, J. Franklin, and I. Moraru.</text>
2 <text font="6" height="9" left="499" textpieces="0" top="990" width="326">Energy-efcient cluster computing with fawn: workloads and implications. In</text>
2 <text font="6" height="9" left="499" textpieces="0" top="1002" width="135">e-Energy, pages 195204, 2010.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="1016" width="356">[37] V. Vasudevan, J. Franklin, D. Andersen, A. Phanishayee, L. Tan, M. Kaminsky,</text>
2 <text font="6" height="9" left="499" textpieces="0" top="1028" width="316">and I. Moraru. FAWNdamentally Power-efcient Clusters. In HotOS, 2009.</text>
2 <text font="6" height="9" left="475" textpieces="0" top="1041" width="336">[38] Z. Xu, Y.-C. Tu, and X. Wang. Exploring Power-Performance Tradeoffs in</text>
2 <text font="6" height="9" left="499" textpieces="0" top="1053" width="214">Database Systems. In ICDE, pages 485496, 2010.</text>
